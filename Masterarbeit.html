<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Masterarbeit</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Masterarbeit_files/libs/clipboard/clipboard.min.js"></script>
<script src="Masterarbeit_files/libs/quarto-html/quarto.js"></script>
<script src="Masterarbeit_files/libs/quarto-html/popper.min.js"></script>
<script src="Masterarbeit_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Masterarbeit_files/libs/quarto-html/anchor.min.js"></script>
<link href="Masterarbeit_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Masterarbeit_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Masterarbeit_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Masterarbeit_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Masterarbeit_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Masterarbeit</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="quarto" class="level2">
<h2 class="anchored" data-anchor-id="quarto">Quarto</h2>
<p>Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <a href="https://quarto.org" class="uri">https://quarto.org</a>.</p>
</section>
<section id="running-code" class="level2">
<h2 class="anchored" data-anchor-id="running-code">Running Code</h2>
<p>When you click the <strong>Render</strong> button a document will be generated that includes both content and the output of embedded code. You can embed code like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>You can add options to executable code like this</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>The <code>echo: false</code> option disables the printing of code (only output is displayed). ## Load necessary libraries</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-reading" class="level2">
<h2 class="anchored" data-anchor-id="data-reading">Data Reading</h2>
<p><strong>Description:</strong> Define directory and combine single data files into one dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the directory containing the files</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>data_directory <span class="ot">&lt;-</span> <span class="st">"/Users/linabecker/Documents/M.Sc. Health Science/Masterarbeit/Masterarbeit"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># List all CSV files in the directory</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>file_list <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> data_directory, <span class="at">pattern =</span> <span class="st">"*.csv"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store individual data frames</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each file to read, process, and add to data_list</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (file <span class="cf">in</span> file_list) {</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the ID from the filename</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  id <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"_.*"</span>, <span class="st">""</span>, <span class="fu">basename</span>(file))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read the file, skipping the first row and using the second row as the header</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file, <span class="at">skip =</span> <span class="dv">1</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the ID column</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>ID <span class="ot">&lt;-</span> id</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Append the processed data frame to the list</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  data_list[[<span class="fu">length</span>(data_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> df</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all individual data frames into one</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_list)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co"># View the combined data </span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(combined_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Device                        Serial.Number Device.Timestamp
1 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:07
2 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:12
3 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:17
4 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:22
5 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:27
6 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:32
  Record.Type Historic.Glucose.mg.dL Scan.Glucose.mg.dL
1           0                     94                 NA
2           0                     90                 NA
3           0                     90                 NA
4           0                     92                 NA
5           0                     97                 NA
6           0                     98                 NA
  Non.numeric.Rapid.Acting.Insulin Rapid.Acting.Insulin..units.
1                               NA                           NA
2                               NA                           NA
3                               NA                           NA
4                               NA                           NA
5                               NA                           NA
6                               NA                           NA
  Non.numeric.Food Carbohydrates..grams. Carbohydrates..servings.
1               NA                    NA                       NA
2               NA                    NA                       NA
3               NA                    NA                       NA
4               NA                    NA                       NA
5               NA                    NA                       NA
6               NA                    NA                       NA
  Non.numeric.Long.Acting.Insulin Long.Acting.Insulin.Value..units. Notes
1                              NA                                NA      
2                              NA                                NA      
3                              NA                                NA      
4                              NA                                NA      
5                              NA                                NA      
6                              NA                                NA      
  Strip.Glucose.mg.dL Ketone.mmol.L Meal.Insulin..units.
1                  NA            NA                   NA
2                  NA            NA                   NA
3                  NA            NA                   NA
4                  NA            NA                   NA
5                  NA            NA                   NA
6                  NA            NA                   NA
  Correction.Insulin..units. User.Change.Insulin..units.          ID
1                         NA                          NA 102Ecosleep
2                         NA                          NA 102Ecosleep
3                         NA                          NA 102Ecosleep
4                         NA                          NA 102Ecosleep
5                         NA                          NA 102Ecosleep
6                         NA                          NA 102Ecosleep</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a summary of unique IDs</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>id_summary <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>id_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  n
1 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert ID to a factor</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.factor</span>(ID))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the columns</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">DeviceTimestamp =</span> Device.Timestamp,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Glucose levels (mg/dl)</span><span class="st">`</span> <span class="ot">=</span> Historic.Glucose.mg.dL,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Scan glucose levels (mg/dl)</span><span class="st">`</span> <span class="ot">=</span> Scan.Glucose.mg.dL</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># View the updated column names (optional)</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(combined_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Device"                            "Serial.Number"                    
 [3] "DeviceTimestamp"                   "Record.Type"                      
 [5] "Glucose levels (mg/dl)"            "Scan glucose levels (mg/dl)"      
 [7] "Non.numeric.Rapid.Acting.Insulin"  "Rapid.Acting.Insulin..units."     
 [9] "Non.numeric.Food"                  "Carbohydrates..grams."            
[11] "Carbohydrates..servings."          "Non.numeric.Long.Acting.Insulin"  
[13] "Long.Acting.Insulin.Value..units." "Notes"                            
[15] "Strip.Glucose.mg.dL"               "Ketone.mmol.L"                    
[17] "Meal.Insulin..units."              "Correction.Insulin..units."       
[19] "User.Change.Insulin..units."       "ID"                               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the Timestamp column to POSIXct format</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>combined_data<span class="sc">$</span>Timestamp <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(combined_data<span class="sc">$</span>DeviceTimestamp, <span class="at">format =</span> <span class="st">"%d-%m-%Y %H:%M"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the structure to confirm the change</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(combined_data<span class="sc">$</span>Timestamp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> POSIXct[1:410262], format: "2024-03-11 09:07:00" "2024-03-11 09:12:00" "2024-03-11 09:17:00" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns, placing Timestamp as the fourth column</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, Timestamp, <span class="fu">everything</span>())<span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Timestamp)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Check all values of Record Types</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(combined_data<span class="sc">$</span>Record.Type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    0.00    0.00    1.16    0.00    6.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(combined_data<span class="sc">$</span>Record.Type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     0      1      5      6 
324056   8254     11  77941 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the data as specified</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove rows where Record.Type is 5 or 6</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Record.Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a new column 'Glucose level'</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Glucose (mg/dl)"</span> <span class="ot">=</span> <span class="fu">if_else</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Glucose levels (mg/dl)</span><span class="st">`</span>), </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose levels (mg/dl)</span><span class="st">`</span>, </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Scan glucose levels (mg/dl)</span><span class="st">`</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first few rows to verify</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(combined_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Device                        Serial.Number  DeviceTimestamp
1 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:07
2 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:12
3 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:17
4 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:22
5 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:27
6 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:32
            Timestamp Record.Type Glucose levels (mg/dl)
1 2024-03-11 09:07:00           0                     94
2 2024-03-11 09:12:00           0                     90
3 2024-03-11 09:17:00           0                     90
4 2024-03-11 09:22:00           0                     92
5 2024-03-11 09:27:00           0                     97
6 2024-03-11 09:32:00           0                     98
  Scan glucose levels (mg/dl) Non.numeric.Rapid.Acting.Insulin
1                          NA                               NA
2                          NA                               NA
3                          NA                               NA
4                          NA                               NA
5                          NA                               NA
6                          NA                               NA
  Rapid.Acting.Insulin..units. Non.numeric.Food Carbohydrates..grams.
1                           NA               NA                    NA
2                           NA               NA                    NA
3                           NA               NA                    NA
4                           NA               NA                    NA
5                           NA               NA                    NA
6                           NA               NA                    NA
  Carbohydrates..servings. Non.numeric.Long.Acting.Insulin
1                       NA                              NA
2                       NA                              NA
3                       NA                              NA
4                       NA                              NA
5                       NA                              NA
6                       NA                              NA
  Long.Acting.Insulin.Value..units. Notes Strip.Glucose.mg.dL Ketone.mmol.L
1                                NA                        NA            NA
2                                NA                        NA            NA
3                                NA                        NA            NA
4                                NA                        NA            NA
5                                NA                        NA            NA
6                                NA                        NA            NA
  Meal.Insulin..units. Correction.Insulin..units. User.Change.Insulin..units.
1                   NA                         NA                          NA
2                   NA                         NA                          NA
3                   NA                         NA                          NA
4                   NA                         NA                          NA
5                   NA                         NA                          NA
6                   NA                         NA                          NA
           ID Glucose (mg/dl)
1 102Ecosleep              94
2 102Ecosleep              90
3 102Ecosleep              90
4 102Ecosleep              92
5 102Ecosleep              97
6 102Ecosleep              98</code></pre>
</div>
</div>
<p><strong>Description:</strong> Get an overview of distribution of historic and scanned glucose data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out rows where both glucose values are missing</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>glucose_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Glucose levels (mg/dl)</span><span class="st">`</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Scan glucose levels (mg/dl)</span><span class="st">`</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all participants in one faceted plot</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(glucose_data, <span class="fu">aes</span>(<span class="at">x =</span> Timestamp)) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Glucose levels (mg/dl)</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Scan glucose levels (mg/dl)</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span>  <span class="co"># One plot per ID, flexible x-axis</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Glucose Measurements Over Time by Participant"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Blue = Historic Glucose (5 min), Red = Scan Glucose (manual scan)"</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time"</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Glucose Level (mg/dL)"</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 324056 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h2>
<p><strong>Description:</strong> filter out all columns not needed and filter out all glucose levels, which are not historic glucose levels (which are scan glucose levels)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out rows with NA or infinite values in Timestamp and Glucose levels columns</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Timestamp), <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Glucose levels (mg/dl)</span><span class="st">`</span>), <span class="fu">is.finite</span>(<span class="st">`</span><span class="at">Glucose levels (mg/dl)</span><span class="st">`</span>))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cleaned_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Device                        Serial.Number  DeviceTimestamp
1 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:07
2 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:12
3 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:17
4 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:22
5 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:27
6 FreeStyle Libre 3 445B278E-A42C-4AAD-9A7F-133BF591A6A7 11-03-2024 09:32
            Timestamp Record.Type Glucose levels (mg/dl)
1 2024-03-11 09:07:00           0                     94
2 2024-03-11 09:12:00           0                     90
3 2024-03-11 09:17:00           0                     90
4 2024-03-11 09:22:00           0                     92
5 2024-03-11 09:27:00           0                     97
6 2024-03-11 09:32:00           0                     98
  Scan glucose levels (mg/dl) Non.numeric.Rapid.Acting.Insulin
1                          NA                               NA
2                          NA                               NA
3                          NA                               NA
4                          NA                               NA
5                          NA                               NA
6                          NA                               NA
  Rapid.Acting.Insulin..units. Non.numeric.Food Carbohydrates..grams.
1                           NA               NA                    NA
2                           NA               NA                    NA
3                           NA               NA                    NA
4                           NA               NA                    NA
5                           NA               NA                    NA
6                           NA               NA                    NA
  Carbohydrates..servings. Non.numeric.Long.Acting.Insulin
1                       NA                              NA
2                       NA                              NA
3                       NA                              NA
4                       NA                              NA
5                       NA                              NA
6                       NA                              NA
  Long.Acting.Insulin.Value..units. Notes Strip.Glucose.mg.dL Ketone.mmol.L
1                                NA                        NA            NA
2                                NA                        NA            NA
3                                NA                        NA            NA
4                                NA                        NA            NA
5                                NA                        NA            NA
6                                NA                        NA            NA
  Meal.Insulin..units. Correction.Insulin..units. User.Change.Insulin..units.
1                   NA                         NA                          NA
2                   NA                         NA                          NA
3                   NA                         NA                          NA
4                   NA                         NA                          NA
5                   NA                         NA                          NA
6                   NA                         NA                          NA
           ID Glucose (mg/dl)
1 102Ecosleep              94
2 102Ecosleep              90
3 102Ecosleep              90
4 102Ecosleep              92
5 102Ecosleep              97
6 102Ecosleep              98</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Rapid.Acting.Insulin..units., <span class="sc">-</span>Ketone.mmol.L, <span class="sc">-</span>Non.numeric.Rapid.Acting.Insulin, <span class="sc">-</span>Non.numeric.Food, <span class="sc">-</span>Carbohydrates..grams.,<span class="sc">-</span>Carbohydrates..servings., <span class="sc">-</span>Non.numeric.Long.Acting.Insulin, <span class="sc">-</span>Long.Acting.Insulin.Value..units., <span class="sc">-</span>Notes, <span class="sc">-</span>Strip.Glucose.mg.dL, <span class="sc">-</span>Meal.Insulin..units., <span class="sc">-</span>Correction.Insulin..units., <span class="sc">-</span>User.Change.Insulin..units.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description:</strong> check if there are missings in glucose values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column to indicate missing or non-finite values in Glucose (1 = Missing/Non-finite, 0 = Present)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.finite</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how many columns have the value 1 in Missings</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(cleaned_data<span class="sc">$</span>Missing <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p><strong>Description</strong>: Create a table showing an overview of expected number versus real number of measurements per ID per Month</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Determine the start date for each ID (earliest timestamp)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>id_start_dates <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Start_Date =</span> <span class="fu">min</span>(Timestamp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) , <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Join the start date back to the main data and filter to include only records from the start date onward</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>cleaned_data_filtered <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(id_start_dates, <span class="at">by =</span> <span class="st">"ID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Timestamp <span class="sc">&gt;=</span> Start_Date <span class="sc">|</span> <span class="fu">is.na</span>(Timestamp))  <span class="co"># Include rows where Timestamp is NA as well</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong>: Table with overview</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Schritt 1: Füge Monat und Jahr-Spalte hinzu</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>glucose_monthly_summary <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">floor_date</span>(Timestamp, <span class="st">"month"</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Month) <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Measured_Values =</span> <span class="fu">n</span>(),  <span class="co"># Tatsächlich gemessene Werte</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Days_Observed =</span> <span class="fu">n_distinct</span>(<span class="fu">as.Date</span>(Timestamp)),  <span class="co"># Anzahl untersuchter Tage im Monat</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Expected_Values =</span> Days_Observed <span class="sc">*</span> <span class="dv">288</span>,  <span class="co"># Erwartet: 288 Werte pro Tag</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing_Values =</span> Expected_Values <span class="sc">-</span> Measured_Values,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing_Percentage =</span> <span class="fu">round</span>((Missing_Values <span class="sc">/</span> Expected_Values) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Ausgabe anzeigen</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>glucose_monthly_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 7
   ID          Month               Measured_Values Days_Observed Expected_Values
   &lt;fct&gt;       &lt;dttm&gt;                        &lt;int&gt;         &lt;int&gt;           &lt;dbl&gt;
 1 102Ecosleep 2024-03-01 00:00:00            5896            21            6048
 2 102Ecosleep 2024-04-01 00:00:00            8244            31            8928
 3 102Ecosleep 2024-05-01 00:00:00            7502            29            8352
 4 102Ecosleep 2024-06-01 00:00:00            4898            19            5472
 5 102Ecosleep 2024-07-01 00:00:00            2084             9            2592
 6 102Ecosleep 2024-08-01 00:00:00            7502            28            8064
 7 102Ecosleep 2024-09-01 00:00:00            8019            30            8640
 8 102Ecosleep 2024-10-01 00:00:00            6023            23            6624
 9 102Ecosleep 2024-11-01 00:00:00            3787            14            4032
10 102Ecosleep 2024-12-01 00:00:00            5947            24            6912
# ℹ 45 more rows
# ℹ 2 more variables: Missing_Values &lt;dbl&gt;, Missing_Percentage &lt;dbl&gt;</code></pre>
</div>
</div>
<p><strong>Description</strong>: Add months to table when no measurement took place</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Schritt 1: Monat berechnen</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>data_with_month <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">floor_date</span>(Timestamp, <span class="st">"month"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Schritt 2: Erster Monat pro ID</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>first_months <span class="ot">&lt;-</span> data_with_month <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">First_Month =</span> <span class="fu">min</span>(Month), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Schritt 3: Vollständigen Monatsraster erzeugen (13 Monate ab Start)</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>full_months_per_id <span class="ot">&lt;-</span> first_months <span class="sc">%&gt;%</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">list</span>(<span class="fu">seq</span>(First_Month, <span class="at">by =</span> <span class="st">"1 month"</span>, <span class="at">length.out =</span> <span class="dv">13</span>))</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(Month) <span class="sc">%&gt;%</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Schritt 4: Tatsächlich gemessene Werte zählen pro ID und Monat</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>monthly_counts <span class="ot">&lt;-</span> data_with_month <span class="sc">%&gt;%</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Month) <span class="sc">%&gt;%</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Measured_Values =</span> <span class="fu">n</span>(),</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Days_Observed =</span> <span class="fu">n_distinct</span>(<span class="fu">as.Date</span>(Timestamp)),</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Schritt 5: Join mit vollständigem Raster + fehlende Werte auffüllen</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>monthly_summary <span class="ot">&lt;-</span> full_months_per_id <span class="sc">%&gt;%</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(monthly_counts, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Measured_Values =</span> <span class="fu">replace_na</span>(Measured_Values, <span class="dv">0</span>),</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Days_Observed =</span> <span class="fu">replace_na</span>(Days_Observed, <span class="dv">0</span>),</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">Expected_Values =</span> <span class="fu">days_in_month</span>(Month) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">12</span>,  <span class="co"># 12 Messungen pro Stunde bei 5-minütiger Frequenz</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing_Values =</span> Expected_Values <span class="sc">-</span> Measured_Values,</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing_Percentage =</span> <span class="fu">ifelse</span>(Expected_Values <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, <span class="fu">round</span>((Missing_Values <span class="sc">/</span> Expected_Values) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong>: Duplicates were found, because Missings were minus –&gt; remove duplicates using cleaned_data_filtered</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check for duplicates first</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>cleaned_data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,940 × 11
# Groups:   ID, Timestamp [1,470]
   Device          Serial.Number DeviceTimestamp Timestamp           Record.Type
   &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;           &lt;dttm&gt;                    &lt;int&gt;
 1 FreeStyle Libr… 445B278E-A42… 17-05-2024 15:… 2024-05-17 15:16:00           0
 2 FreeStyle Libr… 445B278E-A42… 17-05-2024 15:… 2024-05-17 15:16:00           0
 3 FreeStyle Libr… 445B278E-A42… 17-05-2024 15:… 2024-05-17 15:21:00           0
 4 FreeStyle Libr… 445B278E-A42… 17-05-2024 15:… 2024-05-17 15:21:00           0
 5 FreeStyle Libr… 445B278E-A42… 17-05-2024 15:… 2024-05-17 15:26:00           0
 6 FreeStyle Libr… 445B278E-A42… 17-05-2024 15:… 2024-05-17 15:26:00           0
 7 FreeStyle Libr… 445B278E-A42… 17-05-2024 15:… 2024-05-17 15:31:00           0
 8 FreeStyle Libr… 445B278E-A42… 17-05-2024 15:… 2024-05-17 15:31:00           0
 9 FreeStyle Libr… 445B278E-A42… 17-05-2024 15:… 2024-05-17 15:36:00           0
10 FreeStyle Libr… 445B278E-A42… 17-05-2024 15:… 2024-05-17 15:36:00           0
# ℹ 2,930 more rows
# ℹ 6 more variables: `Glucose levels (mg/dl)` &lt;int&gt;,
#   `Scan glucose levels (mg/dl)` &lt;int&gt;, ID &lt;fct&gt;, `Glucose (mg/dl)` &lt;int&gt;,
#   Missing &lt;dbl&gt;, Start_Date &lt;dttm&gt;</code></pre>
</div>
</div>
<section id="duplicates" class="level3">
<h3 class="anchored" data-anchor-id="duplicates">Duplicates</h3>
<p><strong>Description</strong>: Check for duplicates</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All Duplicates</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>dup_timestamps <span class="ot">&lt;-</span> cleaned_data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, Timestamp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="identicalexact-duplicates" class="level4">
<h4 class="anchored" data-anchor-id="identicalexact-duplicates">Identical/exact duplicates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>exact_duplicates <span class="ot">&lt;-</span> dup_timestamps <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Timestamp, <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, Serial.Number) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>exact_duplicates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 11
   Device          Serial.Number DeviceTimestamp Timestamp           Record.Type
   &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;           &lt;dttm&gt;                    &lt;int&gt;
 1 FreeStyle Libr… 445B278E-A42… 05-08-2024 15:… 2024-08-05 15:34:00           0
 2 FreeStyle Libr… 445B278E-A42… 05-08-2024 15:… 2024-08-05 15:34:00           0
 3 FreeStyle Libr… 445B278E-A42… 24-11-2024 08:… 2024-11-24 08:06:00           0
 4 FreeStyle Libr… 445B278E-A42… 24-11-2024 08:… 2024-11-24 08:06:00           0
 5 FreeStyle Libr… 445B278E-A42… 24-11-2024 08:… 2024-11-24 08:11:00           0
 6 FreeStyle Libr… 445B278E-A42… 24-11-2024 08:… 2024-11-24 08:11:00           0
 7 FreeStyle Libr… DBE03CAB-A7A… 13-12-2024 11:… 2024-12-13 11:05:00           0
 8 FreeStyle Libr… DBE03CAB-A7A… 13-12-2024 11:… 2024-12-13 11:05:00           0
 9 FreeStyle Libr… DBE03CAB-A7A… 13-12-2024 11:… 2024-12-13 11:55:00           0
10 FreeStyle Libr… DBE03CAB-A7A… 13-12-2024 11:… 2024-12-13 11:55:00           0
11 FreeStyle Libr… 31C3AD69-BB1… 18-06-2024 09:… 2024-06-18 09:54:00           0
12 FreeStyle Libr… 31C3AD69-BB1… 18-06-2024 09:… 2024-06-18 09:54:00           0
13 FreeStyle Libr… 31C3AD69-BB1… 27-10-2024 02:… 2024-10-27 02:56:00           0
14 FreeStyle Libr… 31C3AD69-BB1… 27-10-2024 02:… 2024-10-27 02:56:00           0
# ℹ 6 more variables: `Glucose levels (mg/dl)` &lt;int&gt;,
#   `Scan glucose levels (mg/dl)` &lt;int&gt;, ID &lt;fct&gt;, `Glucose (mg/dl)` &lt;int&gt;,
#   Missing &lt;dbl&gt;, Start_Date &lt;dttm&gt;</code></pre>
</div>
</div>
</section>
<section id="duplicates-with-same-serial.number-but-different-glucose-value" class="level4">
<h4 class="anchored" data-anchor-id="duplicates-with-same-serial.number-but-different-glucose-value">Duplicates with same Serial.Number but different glucose value</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>conflicting_duplicates <span class="ot">&lt;-</span> dup_timestamps <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Timestamp, Serial.Number) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>conflict_summary <span class="ot">&lt;-</span> conflicting_duplicates <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(ID, <span class="at">name =</span> <span class="st">"Conflicting_Measurements"</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>conflict_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  ID          Conflicting_Measurements
  &lt;fct&gt;                          &lt;int&gt;
1 102Ecosleep                      132
2 104Ecosleep                       44
3 107EcoSleep                       22</code></pre>
</div>
</div>
<p><strong>Description:</strong> Plotting those exact duplicates</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. laufende Nummerierung erstellen</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>conflicting_duplicates <span class="ot">&lt;-</span> conflicting_duplicates <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Timestamp, Serial.Number) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Glucose_Row =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. In Wide-Format bringen (zwei Glucose-Werte nebeneinander)</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>conflicts_wide <span class="ot">&lt;-</span> conflicting_duplicates <span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Timestamp, Serial.Number, <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, Glucose_Row) <span class="sc">%&gt;%</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> Glucose_Row,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"Glucose_"</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Glucose_1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Glucose_2))</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Scatterplot: Glucose_1 vs Glucose_2</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(conflicts_wide, <span class="fu">aes</span>(<span class="at">x =</span> Glucose_1, <span class="at">y =</span> Glucose_2, <span class="at">color =</span> ID)) <span class="sc">+</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Comparison of glucose values in conflicting duplicates </span><span class="sc">\n</span><span class="st">(same timestamp, same serialnumber)"</span>,</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Glucose Value 1"</span>,</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Glucose Value 2"</span>,</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"ID"</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Checking differences of duplicates</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>conflicts_wide <span class="ot">&lt;-</span> conflicts_wide <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">duplicate_difference =</span> Glucose_2 <span class="sc">-</span> Glucose_1)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(conflicts_wide, <span class="fu">aes</span>(<span class="at">x =</span> duplicate_difference, <span class="at">fill =</span> ID)) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Differences between Glucose Values"</span>,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Difference: Glucose (mg/dl)"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Number"</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"ID"</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="duplicates-with-different-serial.number-but-same-glucose-value" class="level4">
<h4 class="anchored" data-anchor-id="duplicates-with-different-serial.number-but-same-glucose-value">Duplicates with different Serial.Number but same glucose value</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>duplicates_diff_serial <span class="ot">&lt;-</span> dup_timestamps <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Timestamp, <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(Serial.Number) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>summary_diff_serial <span class="ot">&lt;-</span> duplicates_diff_serial <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(ID, <span class="at">name =</span> <span class="st">"Same_Glucose_Diff_Serial_Count"</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>summary_diff_serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  ID          Same_Glucose_Diff_Serial_Count
  &lt;fct&gt;                                &lt;int&gt;
1 109EcoSleep                           2728</code></pre>
</div>
</div>
</section>
</section>
<section id="irregular-timestamps-less-than-4min-more-than-6min" class="level3">
<h3 class="anchored" data-anchor-id="irregular-timestamps-less-than-4min-more-than-6min">Irregular Timestamps: Less than 4min, more than 6min</h3>
<p><strong>Description</strong>: Calculate timegaps</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>time_gaps <span class="ot">&lt;-</span> cleaned_data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, Timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Time_Diff_Minutes =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(Timestamp, <span class="fu">lag</span>(Timestamp), <span class="at">units =</span> <span class="st">"mins"</span>))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>time_gaps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 324,056 × 12
   Device          Serial.Number DeviceTimestamp Timestamp           Record.Type
   &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;           &lt;dttm&gt;                    &lt;int&gt;
 1 FreeStyle Libr… 445B278E-A42… 11-03-2024 09:… 2024-03-11 09:07:00           0
 2 FreeStyle Libr… 445B278E-A42… 11-03-2024 09:… 2024-03-11 09:12:00           0
 3 FreeStyle Libr… 445B278E-A42… 11-03-2024 09:… 2024-03-11 09:17:00           0
 4 FreeStyle Libr… 445B278E-A42… 11-03-2024 09:… 2024-03-11 09:22:00           0
 5 FreeStyle Libr… 445B278E-A42… 11-03-2024 09:… 2024-03-11 09:27:00           0
 6 FreeStyle Libr… 445B278E-A42… 11-03-2024 09:… 2024-03-11 09:32:00           0
 7 FreeStyle Libr… 445B278E-A42… 11-03-2024 09:… 2024-03-11 09:37:00           0
 8 FreeStyle Libr… 445B278E-A42… 11-03-2024 09:… 2024-03-11 09:42:00           0
 9 FreeStyle Libr… 445B278E-A42… 11-03-2024 09:… 2024-03-11 09:47:00           0
10 FreeStyle Libr… 445B278E-A42… 11-03-2024 09:… 2024-03-11 09:52:00           0
# ℹ 324,046 more rows
# ℹ 7 more variables: `Glucose levels (mg/dl)` &lt;int&gt;,
#   `Scan glucose levels (mg/dl)` &lt;int&gt;, ID &lt;fct&gt;, `Glucose (mg/dl)` &lt;int&gt;,
#   Missing &lt;dbl&gt;, Start_Date &lt;dttm&gt;, Time_Diff_Minutes &lt;dbl&gt;</code></pre>
</div>
</div>
<section id="gaps-more-than-6min" class="level4">
<h4 class="anchored" data-anchor-id="gaps-more-than-6min">Gaps: more than 6min</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>gaps_over_6min <span class="ot">&lt;-</span> time_gaps <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Time_Diff_Minutes) <span class="sc">&amp;</span> Time_Diff_Minutes <span class="sc">&gt;</span> <span class="dv">6</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>gaps_over_6min</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 258 × 12
   Device          Serial.Number DeviceTimestamp Timestamp           Record.Type
   &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;           &lt;dttm&gt;                    &lt;int&gt;
 1 FreeStyle Libr… 445B278E-A42… 14-03-2024 19:… 2024-03-14 19:22:00           0
 2 FreeStyle Libr… 445B278E-A42… 25-03-2024 10:… 2024-03-25 10:26:00           0
 3 FreeStyle Libr… 445B278E-A42… 29-03-2024 19:… 2024-03-29 19:41:00           0
 4 FreeStyle Libr… 445B278E-A42… 01-04-2024 15:… 2024-04-01 15:31:00           0
 5 FreeStyle Libr… 445B278E-A42… 04-04-2024 12:… 2024-04-04 12:21:00           0
 6 FreeStyle Libr… 445B278E-A42… 09-04-2024 10:… 2024-04-09 10:40:00           0
 7 FreeStyle Libr… 445B278E-A42… 11-04-2024 19:… 2024-04-11 19:35:00           0
 8 FreeStyle Libr… 445B278E-A42… 11-04-2024 20:… 2024-04-11 20:00:00           0
 9 FreeStyle Libr… 445B278E-A42… 11-04-2024 20:… 2024-04-11 20:20:00           0
10 FreeStyle Libr… 445B278E-A42… 11-04-2024 22:… 2024-04-11 22:20:00           0
# ℹ 248 more rows
# ℹ 7 more variables: `Glucose levels (mg/dl)` &lt;int&gt;,
#   `Scan glucose levels (mg/dl)` &lt;int&gt;, ID &lt;fct&gt;, `Glucose (mg/dl)` &lt;int&gt;,
#   Missing &lt;dbl&gt;, Start_Date &lt;dttm&gt;, Time_Diff_Minutes &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>summary_over_6min <span class="ot">&lt;-</span> gaps_over_6min <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span> (ID, <span class="at">name =</span> <span class="st">"Gaps_More_Than_6min"</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>summary_over_6min_detail <span class="ot">&lt;-</span> gaps_over_6min <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Time_Diff_Minutes) <span class="sc">%&gt;%</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>(),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, Time_Diff_Minutes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gaps-between-1-and-3min" class="level4">
<h4 class="anchored" data-anchor-id="gaps-between-1-and-3min">Gaps: between 1 and 3min</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>gaps_1_to_3_min <span class="ot">&lt;-</span> time_gaps <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Time_Diff_Minutes) <span class="sc">&amp;</span> Time_Diff_Minutes <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> Time_Diff_Minutes <span class="sc">&lt;=</span> <span class="dv">3</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>summary_1_to_3_min <span class="ot">&lt;-</span> gaps_1_to_3_min <span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(ID, <span class="at">name =</span> <span class="st">"Gaps_Between_1_and_3min"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong>: Categorize time gaps</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>time_gaps_plot <span class="ot">&lt;-</span> time_gaps <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gap_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(Time_Diff_Minutes) <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>      Time_Diff_Minutes <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> Time_Diff_Minutes <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Between 1 and 3"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>      Time_Diff_Minutes <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"Over 6 min"</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>      Time_Diff_Minutes <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Duplicate"</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Normal (4-6 min)"</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-those-timegaps" class="level4">
<h4 class="anchored" data-anchor-id="plotting-those-timegaps">Plotting those timegaps</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(time_gaps_plot, <span class="fu">aes</span>(<span class="at">x =</span> Timestamp)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normaler Bereich (4–6 Minuten) – als Hintergrund</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(time_gaps_plot, Gap_Category <span class="sc">==</span> <span class="st">"Normal (4-6 min)"</span>),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> Time_Diff_Minutes),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray70"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">1.5</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gaps &gt; 6 Minuten – rot</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(time_gaps_plot, Gap_Category <span class="sc">==</span> <span class="st">"Over 6 min"</span>),</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> Time_Diff_Minutes),</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red3"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">1.5</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gaps zwischen 1–3 Minuten – grün</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(time_gaps_plot, Gap_Category <span class="sc">==</span> <span class="st">"Between 1 and 3"</span>),</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> Time_Diff_Minutes),</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"green3"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">1.5</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Zeitabstände zwischen Glukosemessungen pro ID"</span>,</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Rot = &gt;6min, Grün = 1–3min, Grau = 4–6min"</span>,</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Zeitpunkt"</span>,</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Zeitabstand zur vorherigen Messung (Minuten)"</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="serial-numbers" class="level3">
<h3 class="anchored" data-anchor-id="serial-numbers">Serial Numbers</h3>
<p><strong>Description</strong>: Check how many serial numbers per ID</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>serial_number_summary <span class="ot">&lt;-</span> cleaned_data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Serial.Number) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">First_Timestamp =</span> <span class="fu">min</span>(Timestamp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Last_Timestamp =</span> <span class="fu">max</span>(Timestamp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>(),</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, First_Timestamp)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>serial_number_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  ID          Serial.Number        First_Timestamp     Last_Timestamp      Count
  &lt;fct&gt;       &lt;chr&gt;                &lt;dttm&gt;              &lt;dttm&gt;              &lt;int&gt;
1 102Ecosleep 445B278E-A42C-4AAD-… 2024-03-11 09:07:00 2025-03-14 14:53:00 77366
2 104Ecosleep 6BEA15A5-6DDE-488C-… 2024-03-18 08:54:00 2024-05-10 07:47:00 15178
3 104Ecosleep DBE03CAB-A7A2-4E06-… 2024-05-16 13:00:00 2025-03-12 22:46:00 76461
4 107EcoSleep 31C3AD69-BB17-44A8-… 2024-03-25 09:03:00 2025-02-26 12:39:00 56134
5 108EcoSleep 0175A853-C2D3-46AD-… 2024-04-22 10:13:00 2024-06-03 07:50:00 12035
6 109EcoSleep 2dca51a8-cc16-4887-… 2024-04-22 11:35:00 2024-06-08 08:51:00 11680
7 109EcoSleep F6C5F96A-7168-44F8-… 2024-06-03 15:01:00 2025-03-26 11:08:00 34854
8 112EcoSleep NAGD171-G1255        2024-08-11 22:51:00 2025-03-13 09:22:00 40348</code></pre>
</div>
</div>
</section>
<section id="create-dataset-without-duplicates" class="level3">
<h3 class="anchored" data-anchor-id="create-dataset-without-duplicates">Create Dataset without duplicates</h3>
<p><strong>Description</strong> Step 1: deduplicate: exact duplicates</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_deduplicated <span class="ot">&lt;-</span> cleaned_data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(ID, Timestamp, Serial.Number, <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong> Step 2: deduplicate: duplicates with same timestamp and glucose value but not same serial number</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_deduplicated <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(ID, Timestamp, <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong> Step 3: deduplicate: duplicates with same timestamp but different glucose value</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_deduplicated <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  cleaned_data_deduplicated,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  conflicting_duplicates,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"Timestamp"</span>, <span class="st">"Serial.Number"</span>, <span class="st">"Glucose (mg/dl)"</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong>: check how many rows were deleted</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(cleaned_data_filtered) <span class="sc">-</span> <span class="fu">nrow</span>(cleaned_data_deduplicated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1569</code></pre>
</div>
</div>
</section>
<section id="missings-in-duplicated-dataset" class="level3">
<h3 class="anchored" data-anchor-id="missings-in-duplicated-dataset">Missings in Duplicated Dataset</h3>
<p><strong>Description:</strong> per ID, check how many data points there are from the first day of measurement on for one year</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 102</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>target_id_102 <span class="ot">&lt;-</span> <span class="st">"102Ecosleep"</span>               </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>start_date_102 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-03-11"</span>)  </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for this ID and 1-year window</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>filtered_data_102 <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> target_id_102,</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&gt;=</span> start_date_102,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&lt;</span> start_date_102 <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of measurements</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>measurement_count_102 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(filtered_data_102)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 104</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>target_id_104 <span class="ot">&lt;-</span> <span class="st">"104Ecosleep"</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>start_date_104 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-03-18"</span>) </span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for this ID and 1-year window</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>filtered_data_104 <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> target_id_104,</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&gt;=</span> start_date_104,</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&lt;</span> start_date_104 <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of measurements</span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>measurement_count_104 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(filtered_data_104)</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 107</span></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>target_id_107 <span class="ot">&lt;-</span> <span class="st">"107EcoSleep"</span>            </span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>start_date_107 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-03-25"</span>) </span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for this ID and 1-year window</span></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>filtered_data_107 <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> target_id_107,</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&gt;=</span> start_date_107,</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&lt;</span> start_date_107 <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of measurements</span></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>measurement_count_107 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(filtered_data_107)</span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a><span class="co"># 108</span></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>target_id_108 <span class="ot">&lt;-</span> <span class="st">"108EcoSleep"</span>              </span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>start_date_108 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-04-22"</span>)  </span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for this ID and 1-year window</span></span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a>filtered_data_108 <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> target_id_108,</span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&gt;=</span> start_date_108,</span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&lt;</span> start_date_108 <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of measurements</span></span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a>measurement_count_108 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(filtered_data_108)</span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a><span class="co"># 109</span></span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a>target_id_109 <span class="ot">&lt;-</span> <span class="st">"109EcoSleep"</span>            </span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a>start_date_109 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-04-22"</span>)</span>
<span id="cb64-69"><a href="#cb64-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-70"><a href="#cb64-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for this ID and 1-year window</span></span>
<span id="cb64-71"><a href="#cb64-71" aria-hidden="true" tabindex="-1"></a>filtered_data_109 <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb64-72"><a href="#cb64-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb64-73"><a href="#cb64-73" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> target_id_109,</span>
<span id="cb64-74"><a href="#cb64-74" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&gt;=</span> start_date_109,</span>
<span id="cb64-75"><a href="#cb64-75" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&lt;</span> start_date_109 <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span>
<span id="cb64-76"><a href="#cb64-76" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-77"><a href="#cb64-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-78"><a href="#cb64-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of measurements</span></span>
<span id="cb64-79"><a href="#cb64-79" aria-hidden="true" tabindex="-1"></a>measurement_count_109 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(filtered_data_109)</span>
<span id="cb64-80"><a href="#cb64-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-81"><a href="#cb64-81" aria-hidden="true" tabindex="-1"></a><span class="co"># 112</span></span>
<span id="cb64-82"><a href="#cb64-82" aria-hidden="true" tabindex="-1"></a>target_id_112 <span class="ot">&lt;-</span> <span class="st">"112EcoSleep"</span>            </span>
<span id="cb64-83"><a href="#cb64-83" aria-hidden="true" tabindex="-1"></a>start_date_112 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-08-11"</span>)  </span>
<span id="cb64-84"><a href="#cb64-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-85"><a href="#cb64-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for this ID and 1-year window</span></span>
<span id="cb64-86"><a href="#cb64-86" aria-hidden="true" tabindex="-1"></a>filtered_data_112 <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb64-87"><a href="#cb64-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb64-88"><a href="#cb64-88" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> target_id_112,</span>
<span id="cb64-89"><a href="#cb64-89" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&gt;=</span> start_date_112,</span>
<span id="cb64-90"><a href="#cb64-90" aria-hidden="true" tabindex="-1"></a>    Timestamp <span class="sc">&lt;</span> start_date_112 <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span>
<span id="cb64-91"><a href="#cb64-91" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-92"><a href="#cb64-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-93"><a href="#cb64-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of measurements</span></span>
<span id="cb64-94"><a href="#cb64-94" aria-hidden="true" tabindex="-1"></a>measurement_count_112 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(filtered_data_112)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="time-in-range" class="level2">
<h2 class="anchored" data-anchor-id="time-in-range">Time in range</h2>
<section id="general-overview-on-hyper-and-hypo-glucose-per-id" class="level3">
<h3 class="anchored" data-anchor-id="general-overview-on-hyper-and-hypo-glucose-per-id">General overview on hyper and hypo glucose per ID</h3>
<p><strong>Description:</strong> hypo &lt; 70 and hyper &gt; 180</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Glucose_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Hypo"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">180</span> <span class="sc">~</span> <span class="st">"Hyper"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Normal"</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Glucose_Category) <span class="sc">%&gt;%</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 × 4
# Groups:   ID [6]
   ID          Glucose_Category Count Percentage
   &lt;fct&gt;       &lt;chr&gt;            &lt;int&gt;      &lt;dbl&gt;
 1 102Ecosleep Hyper               12        0  
 2 102Ecosleep Hypo              1544        2  
 3 102Ecosleep Normal           75675       98  
 4 104Ecosleep Hyper               25        0  
 5 104Ecosleep Hypo              2273        2.5
 6 104Ecosleep Normal           89295       97.5
 7 107EcoSleep Hyper               11        0  
 8 107EcoSleep Hypo              1202        2.1
 9 107EcoSleep Normal           54897       97.8
10 108EcoSleep Hyper                4        0  
11 108EcoSleep Hypo               327        2.7
12 108EcoSleep Normal           11704       97.2
13 109EcoSleep Hypo               279        0.6
14 109EcoSleep Normal           44891       99.4
15 112EcoSleep Hyper               32        0.1
16 112EcoSleep Hypo              1010        2.5
17 112EcoSleep Normal           39306       97.4</code></pre>
</div>
</div>
</section>
<section id="hyper-and-hypo-in-day-and-night" class="level3">
<h3 class="anchored" data-anchor-id="hyper-and-hypo-in-day-and-night">Hyper and Hypo in Day and Night</h3>
<p><strong>Description</strong>: Adding Day and Night to Dataset: Night from 22h to 6h</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_deduplicated <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hour =</span> <span class="fu">hour</span>(Timestamp),</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Time_of_Day =</span> <span class="fu">case_when</span>(</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>      Hour <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> Hour <span class="sc">&lt;</span> <span class="dv">22</span> <span class="sc">~</span> <span class="st">"Day"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Night"</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong>: Hyper and Hypo in Day and Night</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Glucose_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Hypo"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">180</span> <span class="sc">~</span> <span class="st">"Hyper"</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Normal"</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Time_of_Day, Glucose_Category) <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Time_of_Day) <span class="sc">%&gt;%</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Time_of_Day</th>
<th style="text-align: left;">Glucose_Category</th>
<th style="text-align: right;">Count</th>
<th style="text-align: right;">Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hyper</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">683</td>
<td style="text-align: right;">1.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">50695</td>
<td style="text-align: right;">98.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">861</td>
<td style="text-align: right;">3.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">24980</td>
<td style="text-align: right;">96.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hyper</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">1301</td>
<td style="text-align: right;">2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">59740</td>
<td style="text-align: right;">97.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Hyper</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">3.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">29555</td>
<td style="text-align: right;">96.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hyper</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">812</td>
<td style="text-align: right;">2.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">36793</td>
<td style="text-align: right;">97.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">390</td>
<td style="text-align: right;">2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">18104</td>
<td style="text-align: right;">97.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hyper</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">1.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">7870</td>
<td style="text-align: right;">98.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">4.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">3834</td>
<td style="text-align: right;">95.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">109EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">109EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">29883</td>
<td style="text-align: right;">99.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">109EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">109EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">15008</td>
<td style="text-align: right;">99.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hyper</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">629</td>
<td style="text-align: right;">2.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">26291</td>
<td style="text-align: right;">97.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Hyper</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Hypo</td>
<td style="text-align: right;">381</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">13015</td>
<td style="text-align: right;">97.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Description</strong>: Hyper and Hypo clinically split</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Glucose_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">54</span> <span class="sc">~</span> <span class="st">"Very Low"</span>,                           <span class="co"># Severe Hypo</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">54</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Low"</span>,  <span class="co"># Mild Hypo</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">70</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">180</span> <span class="sc">~</span> <span class="st">"Normal"</span>, <span class="co"># In Range</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">180</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">250</span> <span class="sc">~</span> <span class="st">"High"</span>,  <span class="co"># High</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">250</span> <span class="sc">~</span> <span class="st">"Very High"</span>                          <span class="co"># Very High</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Time_of_Day, Glucose_Category) <span class="sc">%&gt;%</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Time_of_Day) <span class="sc">%&gt;%</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Time_of_Day</th>
<th style="text-align: left;">Glucose_Category</th>
<th style="text-align: right;">Count</th>
<th style="text-align: right;">Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">High</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">643</td>
<td style="text-align: right;">1.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">50695</td>
<td style="text-align: right;">98.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">762</td>
<td style="text-align: right;">2.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">24980</td>
<td style="text-align: right;">96.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">102Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;">0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">High</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">1148</td>
<td style="text-align: right;">1.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">59740</td>
<td style="text-align: right;">97.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">153</td>
<td style="text-align: right;">0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">High</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">832</td>
<td style="text-align: right;">2.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">29555</td>
<td style="text-align: right;">96.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">104Ecosleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">High</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">793</td>
<td style="text-align: right;">2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">36793</td>
<td style="text-align: right;">97.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">334</td>
<td style="text-align: right;">1.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">18104</td>
<td style="text-align: right;">97.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">107EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">0.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">High</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">119</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">7870</td>
<td style="text-align: right;">98.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">4.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">3834</td>
<td style="text-align: right;">95.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">108EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">109EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">109EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">29883</td>
<td style="text-align: right;">99.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">109EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">109EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;">0.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">109EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">15008</td>
<td style="text-align: right;">99.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">109EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">High</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">497</td>
<td style="text-align: right;">1.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">26291</td>
<td style="text-align: right;">97.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Day</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">High</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Low</td>
<td style="text-align: right;">276</td>
<td style="text-align: right;">2.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">13015</td>
<td style="text-align: right;">97.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">112EcoSleep</td>
<td style="text-align: left;">Night</td>
<td style="text-align: left;">Very Low</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">0.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="create-a-graph" class="level3">
<h3 class="anchored" data-anchor-id="create-a-graph">Create a Graph</h3>
<p><strong>Description</strong>: Create color code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>glucose_category_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Very Low"</span> <span class="ot">=</span> <span class="st">"#990000"</span>,   <span class="co"># dark red</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Low"</span> <span class="ot">=</span> <span class="st">"#e60000"</span>,        <span class="co"># lighter red</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Normal"</span> <span class="ot">=</span> <span class="st">"#228B22"</span>,     <span class="co"># green</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"High"</span> <span class="ot">=</span> <span class="st">"#FFA500"</span>,       <span class="co"># orange</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Very High"</span> <span class="ot">=</span> <span class="st">"#CC5500"</span>   <span class="co"># dark orange</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong>: Add glucose category to dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_deduplicated <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Glucose_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">54</span> <span class="sc">~</span> <span class="st">"Very Low"</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">54</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">70</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">180</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">180</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">250</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">250</span> <span class="sc">~</span> <span class="st">"Very High"</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong>: Create Summary of time in range</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>time_in_range_summary <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Glucose_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">54</span> <span class="sc">~</span> <span class="st">"Very Low"</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">54</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">70</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">180</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">180</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">250</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">250</span> <span class="sc">~</span> <span class="st">"Very High"</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Time_of_Day, Glucose_Category) <span class="sc">%&gt;%</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Time_of_Day) <span class="sc">%&gt;%</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong>: Create Bar</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>category_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Very Low"</span> <span class="ot">=</span> <span class="st">"#990000"</span>,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Low"</span> <span class="ot">=</span> <span class="st">"#e60000"</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Normal"</span> <span class="ot">=</span> <span class="st">"#228B22"</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"High"</span> <span class="ot">=</span> <span class="st">"#FFA500"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Very High"</span> <span class="ot">=</span> <span class="st">"#CC5500"</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(time_in_range_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time_of_Day, <span class="at">y =</span> Percentage, <span class="at">fill =</span> Glucose_Category)) <span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> category_colors) <span class="sc">+</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Glucose Ranges by Time of Day"</span>,</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Glucose Category"</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description</strong>: Create a different Graph</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>time_in_range_summary <span class="ot">&lt;-</span> time_in_range_summary <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Glucose_Category =</span> <span class="fu">factor</span>(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    Glucose_Category,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Very Low"</span>, <span class="st">"Low"</span>, <span class="st">"Normal"</span>, <span class="st">"High"</span>, <span class="st">"Very High"</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(time_in_range_summary, <span class="fu">aes</span>(<span class="at">x =</span> Glucose_Category, <span class="at">y =</span> Percentage, <span class="at">color =</span> Glucose_Category)) <span class="sc">+</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> Glucose_Category, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> Percentage), <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(Percentage, <span class="st">"%"</span>)),</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.4</span>,</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> category_colors) <span class="sc">+</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ID <span class="sc">~</span> Time_of_Day) <span class="sc">+</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">130</span>)) <span class="sc">+</span>  <span class="co"># &lt;- Add more space beyond 100%</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Glucose Category by ID and Time of Day"</span>,</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Category"</span>,</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage (%)"</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Plot a donut chart</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>donut_data <span class="ot">&lt;-</span> time_in_range_summary <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">"102Ecosleep"</span>, Time_of_Day <span class="sc">==</span> <span class="st">"Night"</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(donut_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> Percentage, <span class="at">fill =</span> Glucose_Category)) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.5</span>, <span class="fl">2.5</span>) <span class="sc">+</span>  <span class="co"># creates the hole (donut)</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> category_colors) <span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(Percentage, <span class="st">"%"</span>)),</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Glucose Distribution (Night) – 102Ecosleep"</span>,</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Glucose Category"</span>) <span class="sc">+</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="spike-analysis" class="level2">
<h2 class="anchored" data-anchor-id="spike-analysis">Spike analysis</h2>
<section id="category-change" class="level3">
<h3 class="anchored" data-anchor-id="category-change">Category Change</h3>
<p><strong>Description</strong>: How often does the glucose value change form one category to another</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>spike_analysis <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, Timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Glucose_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">54</span> <span class="sc">~</span> <span class="st">"Very Low"</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">54</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">70</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">180</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">180</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">250</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">250</span> <span class="sc">~</span> <span class="st">"Very High"</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prev_Category =</span> <span class="fu">lag</span>(Glucose_Category),</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prev_ID =</span> <span class="fu">lag</span>(ID),</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prev_Time_of_Day =</span> <span class="fu">lag</span>(Time_of_Day),</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Spike =</span> Glucose_Category <span class="sc">!=</span> Prev_Category <span class="sc">&amp;</span> ID <span class="sc">==</span> Prev_ID <span class="sc">&amp;</span> Time_of_Day <span class="sc">==</span> Prev_Time_of_Day</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Spike) <span class="sc">%&gt;%</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">From =</span> Prev_Category,</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">To =</span> Glucose_Category</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Spike_Direction =</span> <span class="fu">paste0</span>(Prev_Category, <span class="st">" → "</span>, Glucose_Category)</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Time_of_Day, Spike_Direction, From, To) <span class="sc">%&gt;%</span></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Spike_Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>spike_percent <span class="ot">&lt;-</span> spike_analysis <span class="sc">%&gt;%</span></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Time_of_Day) <span class="sc">%&gt;%</span></span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Spikes =</span> <span class="fu">sum</span>(Spike_Count),</span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Spike_Count <span class="sc">/</span> Total_Spikes, <span class="dv">1</span>)</span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description:</strong> Plot the Category Change in Percent</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spike_percent, <span class="fu">aes</span>(<span class="at">x =</span> Spike_Direction, <span class="at">y =</span> Percentage, <span class="at">fill =</span> Spike_Direction)) <span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ID <span class="sc">~</span> Time_of_Day) <span class="sc">+</span>  <span class="co"># Rows = IDs, Columns = Day/Night</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Transitions Between Glucose Categories (Spikes)"</span>,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Transition"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage (%)"</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Plot the Category Change in Count</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spike_analysis, <span class="fu">aes</span>(<span class="at">x =</span> Spike_Direction, <span class="at">y =</span> Spike_Count, <span class="at">fill =</span> Spike_Direction)) <span class="sc">+</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Transitions Between Glucose Categories (Spikes)"</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Transition"</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Create a heat map</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>category_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Very Low"</span>, <span class="st">"Low"</span>, <span class="st">"Normal"</span>, <span class="st">"High"</span>, <span class="st">"Very High"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>spike_percent <span class="ot">&lt;-</span> spike_percent <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">From =</span> <span class="fu">factor</span>(From, <span class="at">levels =</span> category_levels),</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">To =</span> <span class="fu">factor</span>(To, <span class="at">levels =</span> category_levels)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spike_percent, <span class="fu">aes</span>(<span class="at">x =</span> From, <span class="at">y =</span> To, <span class="at">fill =</span> Percentage)) <span class="sc">+</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Percentage), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ID <span class="sc">~</span> Time_of_Day) <span class="sc">+</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Transition Heatmap Between Glucose Categories"</span>,</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Previous Category"</span>,</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Current Category"</span>,</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Percent (%)"</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description</strong>: Creat a heatmap with heatmap() function and for all IDs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise raw counts, not percentages</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>overall_data <span class="ot">&lt;-</span> spike_analysis <span class="sc">%&gt;%</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Spike_Direction, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"From"</span>, <span class="st">"To"</span>), <span class="at">sep =</span> <span class="st">" → "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(From, To) <span class="sc">%&gt;%</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Spike_Count =</span> <span class="fu">sum</span>(Spike_Count), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Total transitions for percentage calculation</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>total_spikes_all <span class="ot">&lt;-</span> <span class="fu">sum</span>(overall_data<span class="sc">$</span>Total_Spike_Count)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute true overall percentage</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>overall_data <span class="ot">&lt;-</span> overall_data <span class="sc">%&gt;%</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Total_Spike_Count <span class="sc">/</span> total_spikes_all, <span class="dv">1</span>),</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">From =</span> <span class="fu">factor</span>(From, <span class="at">levels =</span> category_levels),</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">To =</span> <span class="fu">factor</span>(To, <span class="at">levels =</span> category_levels)</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create matrix for pheatmap with reversed row order</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>heatmap_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, </span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">length</span>(category_levels), </span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="fu">length</span>(category_levels),</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">From =</span> <span class="fu">rev</span>(category_levels), <span class="at">To =</span> category_levels)</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Populate matrix</span></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(overall_data))) {</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>  row <span class="ot">&lt;-</span> overall_data<span class="sc">$</span>From[i]</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>  col <span class="ot">&lt;-</span> overall_data<span class="sc">$</span>To[i]</span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>  val <span class="ot">&lt;-</span> overall_data<span class="sc">$</span>Percentage[i]</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>  heatmap_matrix[<span class="fu">as.character</span>(row), <span class="fu">as.character</span>(col)] <span class="ot">&lt;-</span> val</span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with correct percentages: using pheatmap() function to be able to integrate percentages</span></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(</span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>  heatmap_matrix,</span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">display_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">number_format =</span> <span class="st">"%.1f"</span>,  </span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"steelblue"</span>))(<span class="dv">100</span>),</span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Transition Heatmap (Overall Study Percentage)"</span>,</span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">angle_col =</span> <span class="dv">45</span></span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="spike-duration" class="level3">
<h3 class="anchored" data-anchor-id="spike-duration">Spike Duration</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>spike_durations <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, Timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Glucose_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">54</span> <span class="sc">~</span> <span class="st">"Very Low"</span>,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">54</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">70</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">180</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">180</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="dv">250</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">250</span> <span class="sc">~</span> <span class="st">"Very High"</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category_Change =</span> Glucose_Category <span class="sc">!=</span> <span class="fu">lag</span>(Glucose_Category) <span class="sc">|</span> ID <span class="sc">!=</span> <span class="fu">lag</span>(ID)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group consecutive identical categories per ID</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Spike_Group =</span> <span class="fu">cumsum</span>(<span class="fu">replace_na</span>(Category_Change, <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Spike_Group) <span class="sc">%&gt;%</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Start =</span> <span class="fu">min</span>(Timestamp),</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">End =</span> <span class="fu">max</span>(Timestamp),</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Duration_min =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(<span class="fu">max</span>(Timestamp), <span class="fu">min</span>(Timestamp), <span class="at">units =</span> <span class="st">"mins"</span>)),</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="fu">first</span>(Glucose_Category),</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter for spikes only (exclude normal periods)</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Category <span class="sc">!=</span> <span class="st">"Normal"</span>)</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="co"># View spike durations</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(spike_durations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  ID          Spike_Group Start               End                 Duration_min
  &lt;fct&gt;             &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;                     &lt;dbl&gt;
1 102Ecosleep           2 2024-03-12 02:22:00 2024-03-12 02:52:00           30
2 102Ecosleep           4 2024-03-25 20:21:00 2024-03-25 20:21:00            0
3 102Ecosleep           6 2024-03-27 01:11:00 2024-03-27 01:26:00           15
4 102Ecosleep           8 2024-03-28 16:41:00 2024-03-28 16:46:00            5
5 102Ecosleep          10 2024-04-06 08:01:00 2024-04-06 08:01:00            0
6 102Ecosleep          12 2024-04-09 17:20:00 2024-04-09 17:55:00           35
# ℹ 1 more variable: Category &lt;chr&gt;</code></pre>
</div>
</div>
<p><strong>Description</strong>: Plot the Spikes over time</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spike_durations, <span class="fu">aes</span>(<span class="at">x =</span> Start, <span class="at">xend =</span> End, <span class="at">y =</span> ID, <span class="at">yend =</span> ID, <span class="at">color =</span> Category)) <span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> category_colors) <span class="sc">+</span>  <span class="co"># Optional: your color scheme</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Glucose Spikes Over Time"</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time"</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Participant ID"</span>,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Glucose Category"</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="day-and-night-analysis" class="level2">
<h2 class="anchored" data-anchor-id="day-and-night-analysis">Day and Night Analysis</h2>
<section id="defining-day-and-night" class="level3">
<h3 class="anchored" data-anchor-id="defining-day-and-night">Defining Day and Night</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_deduplicated <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hour =</span> <span class="fu">hour</span>(Timestamp),</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Time_of_Day =</span> <span class="fu">case_when</span>(</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>      Hour <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> Hour <span class="sc">&lt;</span> <span class="dv">22</span> <span class="sc">~</span> <span class="st">"Day"</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Night"</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-day-vs-night" class="level3">
<h3 class="anchored" data-anchor-id="plotting-day-vs-night">Plotting Day vs Night</h3>
<p><strong>Description</strong>: Plot 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_data_deduplicated, <span class="fu">aes</span>(<span class="at">x =</span> Timestamp, <span class="at">y =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, <span class="at">color =</span> Time_of_Day)) <span class="sc">+</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_data_deduplicated, <span class="fu">aes</span>(<span class="at">x =</span> Time_of_Day, <span class="at">y =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, <span class="at">fill =</span> Time_of_Day)) <span class="sc">+</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID) <span class="sc">+</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Glukosevalue: Day vs. Night"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Glucose (mg/dl)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description</strong>: Plot 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_data_deduplicated, <span class="fu">aes</span>(<span class="at">x =</span> Timestamp, <span class="at">y =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, <span class="at">color =</span> Time_of_Day)) <span class="sc">+</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Day"</span> <span class="ot">=</span> <span class="st">"orange3"</span>, <span class="st">"Night"</span> <span class="ot">=</span> <span class="st">"midnightblue"</span>)) <span class="sc">+</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Glucose trend over time: Day vs. Night"</span>,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time"</span>,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Glucose (mg/dl)"</span>,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time of Day"</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Plot 3: Daily mean over time + standard deviation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataset with mean and standard deviation</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  cleaned_summary <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">Date =</span> <span class="fu">as.Date</span>(Timestamp)  <span class="co"># date of day</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID, Time_of_Day, Date) <span class="sc">%&gt;%</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_glucose =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd_glucose   =</span> <span class="fu">sd</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create Plot</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(cleaned_summary, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> mean_glucose, <span class="at">color =</span> Time_of_Day, <span class="at">fill =</span> Time_of_Day)) <span class="sc">+</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_glucose <span class="sc">-</span> sd_glucose, <span class="at">ymax =</span> mean_glucose <span class="sc">+</span> sd_glucose), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID) <span class="sc">+</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Day"</span> <span class="ot">=</span> <span class="st">"orange3"</span>, <span class="st">"Night"</span> <span class="ot">=</span> <span class="st">"midnightblue"</span>)) <span class="sc">+</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Day"</span> <span class="ot">=</span> <span class="st">"orange3"</span>, <span class="st">"Night"</span> <span class="ot">=</span> <span class="st">"midnightblue"</span>)) <span class="sc">+</span></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Daily Mean Glucose with Standard Deviation (Day vs. Night)"</span>,</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Mean Glucose (mg/dl)"</span>,</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Time of Day"</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nighttime-glucose" class="level3">
<h3 class="anchored" data-anchor-id="nighttime-glucose">Nighttime Glucose</h3>
<p><strong>Description:</strong> Prepare Data for Graph</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for night data</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>night_data <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Hour =</span> <span class="fu">hour</span>(Timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Hour <span class="sc">&gt;=</span> <span class="dv">22</span> <span class="sc">|</span> Hour <span class="sc">&lt;</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span>  <span class="co"># Nighttime: 22 to 6</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create reordered factor for plotting (22 to 6)</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Hour_Factor =</span> <span class="fu">factor</span>(Hour, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)))</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average glucose per hour per ID</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>night_avg <span class="ot">&lt;-</span> night_data <span class="sc">%&gt;%</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, Hour_Factor) <span class="sc">%&gt;%</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Glucose =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description:</strong> Plot the night</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(night_avg, <span class="fu">aes</span>(<span class="at">x =</span> Hour_Factor, <span class="at">y =</span> Avg_Glucose, <span class="at">group =</span> ID, <span class="at">color =</span> ID)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Nighttime Glucose Trends per ID"</span>,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Hours from 22:00 to 06:00"</span>,</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Night"</span>,</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Glucose (mg/dl)"</span>,</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"ID"</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Boxplot of Average Glucose per Hour</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(night_data, <span class="fu">aes</span>(<span class="at">x =</span> Hour_Factor, <span class="at">y =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, <span class="at">fill =</span> Hour_Factor)) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Nighttime Glucose Distribution per Hour and ID"</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Hours from 22:00 to 06:00"</span>,</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Night"</span>,</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Glucose (mg/dl)"</span>,</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Hour"</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="create-a-double-plot" class="level3">
<h3 class="anchored" data-anchor-id="create-a-double-plot">Create a double plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract time-of-day in hours and add ID names without "Ecosleep"</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>double_data <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Date =</span> <span class="fu">as.Date</span>(Timestamp),</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hour =</span> <span class="fu">hour</span>(Timestamp),</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Minute =</span> <span class="fu">minute</span>(Timestamp),</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Time_of_Day =</span> Hour <span class="sc">+</span> Minute <span class="sc">/</span> <span class="dv">60</span>,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ID_Label =</span> <span class="fu">case_when</span>(</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>      ID <span class="sc">==</span> <span class="st">"102Ecosleep"</span> <span class="sc">~</span> <span class="st">"102"</span>,</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>      ID <span class="sc">==</span> <span class="st">"104Ecosleep"</span> <span class="sc">~</span> <span class="st">"104"</span>,</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>      ID <span class="sc">==</span> <span class="st">"107EcoSleep"</span> <span class="sc">~</span> <span class="st">"107"</span>,</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>      ID <span class="sc">==</span> <span class="st">"108EcoSleep"</span> <span class="sc">~</span> <span class="st">"108"</span>,</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>      ID <span class="sc">==</span> <span class="st">"109EcoSleep"</span> <span class="sc">~</span> <span class="st">"109"</span>,</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>      ID <span class="sc">==</span> <span class="st">"112EcoSleep"</span> <span class="sc">~</span> <span class="st">"112"</span>,</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(ID)</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Duplicate data: original time + shifted by 24h</span></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>double_data_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>  double_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Double_Hour =</span> Time_of_Day),</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>  double_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Double_Hour =</span> Time_of_Day <span class="sc">+</span> <span class="dv">24</span>)</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Round down to full hour and keep the original 0–47 factor for correct time ordering</span></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>double_avg <span class="ot">&lt;-</span> double_data_long <span class="sc">%&gt;%</span></span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Hour_Rounded =</span> <span class="fu">floor</span>(Double_Hour)) <span class="sc">%&gt;%</span></span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID_Label, Hour_Rounded) <span class="sc">%&gt;%</span></span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_Glucose =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Display_Hour =</span> Hour_Rounded <span class="sc">%%</span> <span class="dv">24</span>,</span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Day =</span> <span class="fu">ifelse</span>(Hour_Rounded <span class="sc">&lt;</span> <span class="dv">24</span>, <span class="st">"Day 1"</span>, <span class="st">"Day 2"</span>),</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hour_Label =</span> <span class="fu">paste0</span>(Day, <span class="st">" – "</span>, <span class="fu">sprintf</span>(<span class="st">"%02d:00"</span>, Display_Hour)),</span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hour_Factor =</span> <span class="fu">factor</span>(Hour_Label, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Day 1 – "</span>, <span class="fu">sprintf</span>(<span class="st">"%02d:00"</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">23</span>)),</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"Day 2 – "</span>, <span class="fu">sprintf</span>(<span class="st">"%02d:00"</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">23</span>))</span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(double_avg, <span class="fu">aes</span>(<span class="at">x =</span> Hour_Factor, <span class="at">y =</span> Avg_Glucose, <span class="at">group =</span> ID_Label, <span class="at">color =</span> ID_Label)) <span class="sc">+</span></span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Double Plot: 48-Hour Glucose Trends per ID"</span>,</span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Same 24h cycle shown twice to visualize rhythm"</span>,</span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Day (Repeated)"</span>,</span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Glucose (mg/dl)"</span>,</span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"ID"</span></span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">levels</span>(double_avg<span class="sc">$</span>Hour_Factor)[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">48</span>, <span class="at">by =</span> <span class="dv">4</span>)]</span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb93-58"><a href="#cb93-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb93-59"><a href="#cb93-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb93-60"><a href="#cb93-60" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cosinus-fit" class="level2">
<h2 class="anchored" data-anchor-id="cosinus-fit">Cosinus fit</h2>
<section id="first-fit-for-every-id" class="level3">
<h3 class="anchored" data-anchor-id="first-fit-for-every-id">First fit for every ID</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for ID 102</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>fit_data_102 <span class="ot">&lt;-</span> double_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ID_Label <span class="sc">==</span> <span class="st">"102"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit cosine model (period 24h)</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>cos_fit_102 <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  Avg_Glucose <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> Hour_Rounded <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fit_data_102,</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)  <span class="co"># rough starting guesses</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_102)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: Avg_Glucose ~ A * cos(2 * pi/24 * Hour_Rounded + phi) + C

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)    
A   -6.37619    0.30189  -21.12   &lt;2e-16 ***
phi -1.17838    0.04735  -24.89   &lt;2e-16 ***
C   99.79182    0.21347  467.47   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.479 on 45 degrees of freedom

Number of iterations to convergence: 8 
Achieved convergence tolerance: 7.629e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predicted values</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>fit_data_102 <span class="ot">&lt;-</span> fit_data_102 <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_102))</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot actual vs fitted</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fit_data_102, <span class="fu">aes</span>(<span class="at">x =</span> Hour_Rounded)) <span class="sc">+</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Avg_Glucose), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cosine Fit for ID 102"</span>,</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Day (0–47)"</span>,</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Glucose (mg/dl)"</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>fit_data_104 <span class="ot">&lt;-</span> double_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ID_Label <span class="sc">==</span> <span class="st">"104"</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>cos_fit_104 <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  Avg_Glucose <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> Hour_Rounded <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fit_data_104,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>fit_data_104 <span class="ot">&lt;-</span> fit_data_104 <span class="sc">%&gt;%</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_104))</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fit_data_104, <span class="fu">aes</span>(<span class="at">x =</span> Hour_Rounded)) <span class="sc">+</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Avg_Glucose), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cosine Fit for ID 104"</span>,</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Day (0–47)"</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Glucose (mg/dl)"</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-55-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>fit_data_104 <span class="ot">&lt;-</span> double_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ID_Label <span class="sc">==</span> <span class="st">"104"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>cos_fit_104 <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  Avg_Glucose <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> Hour_Rounded <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fit_data_104,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>fit_data_104 <span class="ot">&lt;-</span> fit_data_104 <span class="sc">%&gt;%</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_104))</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fit_data_104, <span class="fu">aes</span>(<span class="at">x =</span> Hour_Rounded)) <span class="sc">+</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Avg_Glucose), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cosine Fit for ID 104"</span>,</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Day (0–47)"</span>,</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Glucose (mg/dl)"</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-55-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>fit_data_107 <span class="ot">&lt;-</span> double_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ID_Label <span class="sc">==</span> <span class="st">"107"</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>cos_fit_107 <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  Avg_Glucose <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> Hour_Rounded <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fit_data_107,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>fit_data_107 <span class="ot">&lt;-</span> fit_data_107 <span class="sc">%&gt;%</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_107))</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fit_data_107, <span class="fu">aes</span>(<span class="at">x =</span> Hour_Rounded)) <span class="sc">+</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Avg_Glucose), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cosine Fit for ID 107"</span>,</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Day (0–47)"</span>,</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Glucose (mg/dl)"</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-55-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>fit_data_108 <span class="ot">&lt;-</span> double_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ID_Label <span class="sc">==</span> <span class="st">"108"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>cos_fit_108 <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  Avg_Glucose <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> Hour_Rounded <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fit_data_108,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>fit_data_108 <span class="ot">&lt;-</span> fit_data_108 <span class="sc">%&gt;%</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_108))</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fit_data_108, <span class="fu">aes</span>(<span class="at">x =</span> Hour_Rounded)) <span class="sc">+</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Avg_Glucose), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cosine Fit for ID 108"</span>,</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Day (0–47)"</span>,</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Glucose (mg/dl)"</span></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-55-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>fit_data_109 <span class="ot">&lt;-</span> double_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ID_Label <span class="sc">==</span> <span class="st">"109"</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>cos_fit_109 <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  Avg_Glucose <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> Hour_Rounded <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fit_data_109,</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>fit_data_109 <span class="ot">&lt;-</span> fit_data_109 <span class="sc">%&gt;%</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_109))</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fit_data_109, <span class="fu">aes</span>(<span class="at">x =</span> Hour_Rounded)) <span class="sc">+</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Avg_Glucose), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cosine Fit for ID 109"</span>,</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Day (0–47)"</span>,</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Glucose (mg/dl)"</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-55-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>fit_data_112 <span class="ot">&lt;-</span> double_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ID_Label <span class="sc">==</span> <span class="st">"112"</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>cos_fit_112 <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  Avg_Glucose <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> Hour_Rounded <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fit_data_112,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>fit_data_112 <span class="ot">&lt;-</span> fit_data_112 <span class="sc">%&gt;%</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_112))</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fit_data_112, <span class="fu">aes</span>(<span class="at">x =</span> Hour_Rounded)) <span class="sc">+</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Avg_Glucose), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cosine Fit for ID 112"</span>,</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Day (0–47)"</span>,</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Glucose (mg/dl)"</span></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-55-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum bestimmen</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>max_row <span class="ot">&lt;-</span> fit_data_102 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Fitted <span class="sc">==</span> <span class="fu">max</span>(Fitted))</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Maximum:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(max_row <span class="sc">%&gt;%</span> <span class="fu">select</span>(Hour_Rounded, Fitted))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  Hour_Rounded Fitted
         &lt;dbl&gt;  &lt;dbl&gt;
1           17   106.
2           41   106.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum bestimmen</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>min_row <span class="ot">&lt;-</span> fit_data_102 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Fitted <span class="sc">==</span> <span class="fu">min</span>(Fitted))</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Minimum:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Minimum:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(min_row <span class="sc">%&gt;%</span> <span class="fu">select</span>(Hour_Rounded, Fitted))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  Hour_Rounded Fitted
         &lt;dbl&gt;  &lt;dbl&gt;
1            5   93.5
2           29   93.5</code></pre>
</div>
</div>
</section>
<section id="cosinus-fit-with-cosinor" class="level3">
<h3 class="anchored" data-anchor-id="cosinus-fit-with-cosinor">Cosinus fit with cosinor()</h3>
<p><strong>Description</strong>: load cosinor package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cosinor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description</strong>: Test functioning of the package with vitamind data set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"vitamind"</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">head</span>(vitamind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X        Y      time
1 0 16.12091 11.439525
2 0 29.90624  5.807104
3 1 39.17572  1.045492
4 1 35.15403  4.082983
5 1 43.67065 10.606247
6 0 31.20360  5.126054</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a> fit <span class="ot">&lt;-</span> <span class="fu">cosinor.lm</span>(Y <span class="sc">~</span> <span class="fu">time</span>(time) <span class="sc">+</span> X <span class="sc">+</span> <span class="fu">amp.acro</span>(X), <span class="at">data =</span> vitamind, <span class="at">period =</span> <span class="dv">12</span>) </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  29.6898         0.4654  28.7776  30.6020  0.0000
X             1.9019         0.8041   0.3258   3.4779  0.0180
rrr           0.9308         0.6357  -0.3151   2.1767  0.1431
sss           6.2010         0.6805   4.8673   7.5347  0.0000
X:rrr         5.5795         1.1386   3.3479   7.8111  0.0000
X:sss        -1.3825         1.1364  -3.6097   0.8447  0.2237

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  29.6898         0.4654  28.7776  30.6020   0.000
[X = 1]       1.9019         0.8041   0.3258   3.4779   0.018
amp           6.2705         0.6799   4.9378   7.6031   0.000
[X = 1]:amp   8.0995         0.9095   6.3170   9.8820   0.000
acr           1.4218         0.1015   1.2229   1.6207   0.000
[X = 1]:acr   0.6372         0.1167   0.4084   0.8659   0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_cosinor</span>(fit, <span class="st">"X"</span>, <span class="at">param =</span> <span class="st">"amp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Global test: 
Statistic: 
[1] 2.59


 P-value: 
[1] 0.1072

 Individual tests: 
Statistic: 
[1] 1.61


 P-value: 
[1] 0.1072

 Estimate and confidence interval[1] "1.83 (-0.4 to 4.05)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vitamind<span class="sc">$</span>Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  13.27   25.59   29.79   30.09   34.85   51.30 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">predict</span>(fit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  16.10   25.98   29.26   29.69   33.59   46.48 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_cosinor.lm</span>(fit, <span class="at">x_str =</span> <span class="st">"X"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description</strong>: fit cosinor for Ecosleep 102</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataset for cosinor model for 102Ecosleep</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_102_data <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">"102Ecosleep"</span>) <span class="sc">%&gt;%</span>    <span class="co"># filter for 102</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">datetime =</span> <span class="fu">dmy_hm</span>(DeviceTimestamp),  <span class="co">#  if format TT-MM-JJJJ HH:MM</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec.time =</span> <span class="fu">hour</span>(datetime) <span class="sc">+</span> <span class="fu">minute</span>(datetime) <span class="sc">/</span> <span class="dv">60</span>  <span class="co"># time as decimal hour during the day</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co"># cosinor model</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>glucose_fit_102 <span class="ot">&lt;-</span> <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> glucose_fit_102_data, <span class="at">period =</span> <span class="dv">24</span>) </span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_102) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  99.7942         0.0503  99.6956  99.8928       0
rrr          -1.6710         0.0711  -1.8103  -1.5318       0
sss          -6.1713         0.0712  -6.3108  -6.0317       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  99.7942         0.0503  99.6956  99.8928       0
amp           6.3935         0.0712   6.2540   6.5330       0
acr           1.3064         0.0111   1.2846   1.3282       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raw values</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_102_data<span class="sc">$</span><span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  40.00   91.00   99.00   99.79  108.00  196.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted values</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">predict</span>(glucose_fit_102))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  37.44   91.57   99.66   99.79  107.85  189.93 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the fit</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_cosinor.lm</span>(glucose_fit_102)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description</strong>: fit cosinor for Ecosleep 104</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataset for cosinor model for 102Ecosleep</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_104_data <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">"104Ecosleep"</span>) <span class="sc">%&gt;%</span>    <span class="co"># filter for 104</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">datetime =</span> <span class="fu">dmy_hm</span>(DeviceTimestamp),  <span class="co">#  if format TT-MM-JJJJ HH:MM</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec.time =</span> <span class="fu">hour</span>(datetime) <span class="sc">+</span> <span class="fu">minute</span>(datetime) <span class="sc">/</span> <span class="dv">60</span>  <span class="co"># time as decimal hour during the day</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="co"># cosinor model</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>glucose_fit_104 <span class="ot">&lt;-</span> <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> glucose_fit_104_data, <span class="at">period =</span> <span class="dv">24</span>) </span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_102) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  99.7942         0.0503  99.6956  99.8928       0
rrr          -1.6710         0.0711  -1.8103  -1.5318       0
sss          -6.1713         0.0712  -6.3108  -6.0317       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  99.7942         0.0503  99.6956  99.8928       0
amp           6.3935         0.0712   6.2540   6.5330       0
acr           1.3064         0.0111   1.2846   1.3282       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raw values</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_104_data<span class="sc">$</span><span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     40      92      99     100     108     223 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted values</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">predict</span>(glucose_fit_104))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  36.50   91.53   99.61  100.01  107.78  219.58 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the fit</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_cosinor.lm</span>(glucose_fit_104)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description</strong>: fit cosinor for Ecosleep 107</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataset for cosinor model for 107Ecosleep</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_107_data <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">"107EcoSleep"</span>) <span class="sc">%&gt;%</span>    <span class="co"># filter for 107</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">datetime =</span> <span class="fu">dmy_hm</span>(DeviceTimestamp),  <span class="co">#  if format TT-MM-JJJJ HH:MM</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec.time =</span> <span class="fu">hour</span>(datetime) <span class="sc">+</span> <span class="fu">minute</span>(datetime) <span class="sc">/</span> <span class="dv">60</span>  <span class="co"># time as decimal hour during the day</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="co"># cosinor model</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>glucose_fit_107 <span class="ot">&lt;-</span> <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> glucose_fit_107_data, <span class="at">period =</span> <span class="dv">24</span>) </span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_107) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  99.8672         0.0702  99.7297 100.0047       0
rrr           3.1165         0.0992   2.9221   3.3108       0
sss          -5.2599         0.0993  -5.4545  -5.0653       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  99.8672         0.0702  99.7297 100.0047       0
amp           6.1138         0.0993   5.9192   6.3085       0
acr          -1.0359         0.0162  -1.0677  -1.0041       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raw values</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_107_data<span class="sc">$</span><span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  40.00   89.00   98.00   99.87  109.00  197.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted values</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">predict</span>(glucose_fit_107))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  34.14   89.62   98.86   99.87  108.84  190.93 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the fit</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_cosinor.lm</span>(glucose_fit_107)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description</strong>: fit cosinor for Ecosleep 108</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataset for cosinor model for 107Ecosleep</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_108_data <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">"108EcoSleep"</span>) <span class="sc">%&gt;%</span>    <span class="co"># filter for 107</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">datetime =</span> <span class="fu">dmy_hm</span>(DeviceTimestamp),  <span class="co">#  if format TT-MM-JJJJ HH:MM</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec.time =</span> <span class="fu">hour</span>(datetime) <span class="sc">+</span> <span class="fu">minute</span>(datetime) <span class="sc">/</span> <span class="dv">60</span>  <span class="co"># time as decimal hour during the day</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co"># cosinor model</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>glucose_fit_108 <span class="ot">&lt;-</span> <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> glucose_fit_108_data, <span class="at">period =</span> <span class="dv">24</span>) </span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_108) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept) 105.5868         0.1440 105.3046 105.8690       0
rrr          -2.9873         0.2036  -3.3864  -2.5881       0
sss         -12.0471         0.2036 -12.4461 -11.6481       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept) 105.5868         0.1440 105.3046 105.8690       0
amp          12.4119         0.2034  12.0133  12.8105       0
acr           1.3277         0.0164   1.2955   1.3599       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raw values</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_108_data<span class="sc">$</span><span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   52.0    95.0   104.0   105.6   116.0   193.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted values</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">predict</span>(glucose_fit_108))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  44.42   96.94  105.39  105.59  113.24  185.47 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the fit</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_cosinor.lm</span>(glucose_fit_108)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description</strong>: fit cosinor for Ecosleep 109</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataset for cosinor model for 107Ecosleep</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_109_data <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">"109EcoSleep"</span>) <span class="sc">%&gt;%</span>    <span class="co"># filter for 109</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">datetime =</span> <span class="fu">dmy_hm</span>(DeviceTimestamp),  <span class="co">#  if format TT-MM-JJJJ HH:MM</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec.time =</span> <span class="fu">hour</span>(datetime) <span class="sc">+</span> <span class="fu">minute</span>(datetime) <span class="sc">/</span> <span class="dv">60</span>  <span class="co"># time as decimal hour during the day</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="co"># cosinor model</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>glucose_fit_109 <span class="ot">&lt;-</span> <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> glucose_fit_109_data, <span class="at">period =</span> <span class="dv">24</span>) </span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_109) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept) 102.1091         0.0606 101.9904 102.2278       0
rrr           1.0739         0.0857   0.9060   1.2418       0
sss          -7.8340         0.0856  -8.0019  -7.6661       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept) 102.1091         0.0606 101.9904 102.2278       0
amp           7.9073         0.0856   7.7394   8.0751       0
acr          -1.4346         0.0108  -1.4558  -1.4133       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raw values</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_109_data<span class="sc">$</span><span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   40.0    93.0   100.0   102.1   110.0   179.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted values</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">predict</span>(glucose_fit_109))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  38.99   93.70  101.06  102.11  109.15  184.09 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the fit</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_cosinor.lm</span>(glucose_fit_109)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description</strong>: fit cosinor for Ecosleep 112</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataset for cosinor model for 112Ecosleep</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_112_data <span class="ot">&lt;-</span> cleaned_data_deduplicated <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">"112EcoSleep"</span>) <span class="sc">%&gt;%</span>    <span class="co"># filter for 112</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">datetime =</span> <span class="fu">dmy_hm</span>(DeviceTimestamp),  <span class="co">#  if format TT-MM-JJJJ HH:MM</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec.time =</span> <span class="fu">hour</span>(datetime) <span class="sc">+</span> <span class="fu">minute</span>(datetime) <span class="sc">/</span> <span class="dv">60</span>  <span class="co"># time as decimal hour during the day</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="co"># cosinor model</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>glucose_fit_112 <span class="ot">&lt;-</span> <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> glucose_fit_112_data, <span class="at">period =</span> <span class="dv">24</span>) </span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_112) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  98.3816         0.0785  98.2277  98.5355       0
rrr           4.6835         0.1110   4.4660   4.9010       0
sss          -7.5482         0.1111  -7.7660  -7.3305       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  98.3816         0.0785  98.2277  98.5355       0
amp           8.8832         0.1113   8.6651   9.1013       0
acr          -1.0155         0.0125  -1.0399  -0.9910       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raw values</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_112_data<span class="sc">$</span><span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  40.00   87.00   96.00   98.38  107.00  213.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted values</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">predict</span>(glucose_fit_112))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  43.89   89.16   96.57   98.38  105.91  218.02 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the fit</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_cosinor.lm</span>(glucose_fit_112)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="manual-consinus-fit-but-with-datasets-prepared-for-fit-with-cosinor-function---no-hourly-bins-but-all-datapoints" class="level3">
<h3 class="anchored" data-anchor-id="manual-consinus-fit-but-with-datasets-prepared-for-fit-with-cosinor-function---no-hourly-bins-but-all-datapoints">Manual Consinus fit but with datasets prepared for fit with cosinor() function (-&gt; no hourly bins but all datapoints)</h3>
<p><strong>Description</strong>: Fit for 102</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>cos_fit_102_orig <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> dec.time <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> glucose_fit_102_data,</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)  <span class="co"># start values</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ergebnis anzeigen</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_102_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)    
A    6.39349    0.07116   89.84   &lt;2e-16 ***
phi -4.44795    0.01112 -399.88   &lt;2e-16 ***
C   99.79418    0.05030 1983.89   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.98 on 77228 degrees of freedom

Number of iterations to convergence: 10 
Achieved convergence tolerance: 1.922e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare dataset for plotting</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_102_data <span class="ot">&lt;-</span> glucose_fit_102_data <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_102_orig))</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(glucose_fit_102_data, <span class="fu">aes</span>(<span class="at">x =</span> dec.time, <span class="at">y =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span>  <span class="co"># Original glucose values</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Cosinus fit</span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Manual Cosinus-Fit for 102 with original data"</span>,</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"time (decimal hours)"</span>,</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Glucose (mg/dl)"</span>) <span class="sc">+</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Desciption:</strong> Fit for 104</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>cos_fit_104_orig <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> dec.time <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> glucose_fit_104_data,</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)  <span class="co"># start values</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ergebnis anzeigen</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_104_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
     Estimate Std. Error t value Pr(&gt;|t|)    
A     3.50090    0.06912   50.65   &lt;2e-16 ***
phi   1.29380    0.01973   65.56   &lt;2e-16 ***
C   100.01206    0.04886 2046.78   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.79 on 91590 degrees of freedom

Number of iterations to convergence: 7 
Achieved convergence tolerance: 1.57e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare dataset for plotting</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_104_data <span class="ot">&lt;-</span> glucose_fit_104_data <span class="sc">%&gt;%</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_104_orig))</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(glucose_fit_104_data, <span class="fu">aes</span>(<span class="at">x =</span> dec.time, <span class="at">y =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span>  <span class="co"># Original glucose values</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Cosinus fit</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Manual Cosinus-Fit for 104 with original data"</span>,</span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"time (decimal hours)"</span>,</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Glucose (mg/dl)"</span>) <span class="sc">+</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Desciption:</strong> Fit for 107</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>cos_fit_107_orig <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> dec.time <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> glucose_fit_107_data,</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)  <span class="co"># start values</span></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ergebnis anzeigen</span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_107_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)    
A    6.11375    0.09932   61.56   &lt;2e-16 ***
phi  1.03591    0.01622   63.88   &lt;2e-16 ***
C   99.86721    0.07017 1423.26   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 16.62 on 56107 degrees of freedom

Number of iterations to convergence: 5 
Achieved convergence tolerance: 3.927e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare dataset for plotting</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_107_data <span class="ot">&lt;-</span> glucose_fit_107_data <span class="sc">%&gt;%</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_107_orig))</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(glucose_fit_107_data, <span class="fu">aes</span>(<span class="at">x =</span> dec.time, <span class="at">y =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span>  <span class="co"># Original glucose values</span></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Cosinus fit</span></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Manual Cosinus-Fit for 107 with original data"</span>,</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"time (decimal hours)"</span>,</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Glucose (mg/dl)"</span>) <span class="sc">+</span></span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Fit for 108</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>cos_fit_108_orig <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> dec.time <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> glucose_fit_108_data,</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)  <span class="co"># start values</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ergebnis anzeigen</span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_108_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
     Estimate Std. Error t value Pr(&gt;|t|)    
A    12.41194    0.20337   61.03   &lt;2e-16 ***
phi  20.66341    0.01642 1258.09   &lt;2e-16 ***
C   105.58679    0.14398  733.36   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.79 on 12032 degrees of freedom

Number of iterations to convergence: 11 
Achieved convergence tolerance: 2.572e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare dataset for plotting</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_108_data <span class="ot">&lt;-</span> glucose_fit_108_data <span class="sc">%&gt;%</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_108_orig))</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(glucose_fit_108_data, <span class="fu">aes</span>(<span class="at">x =</span> dec.time, <span class="at">y =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span>  <span class="co"># Original glucose values</span></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Cosinus fit</span></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Manual Cosinus-Fit for 108 with original data"</span>,</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"time (decimal hours)"</span>,</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Glucose (mg/dl)"</span>) <span class="sc">+</span></span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Fit for 109</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>cos_fit_109_orig <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> dec.time <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> glucose_fit_109_data,</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)  <span class="co"># start values</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ergebnis anzeigen</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_109_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
     Estimate Std. Error t value Pr(&gt;|t|)    
A     7.90726    0.08563   92.35   &lt;2e-16 ***
phi   1.43456    0.01083  132.41   &lt;2e-16 ***
C   102.10915    0.06056 1686.00   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.87 on 45167 degrees of freedom

Number of iterations to convergence: 7 
Achieved convergence tolerance: 2.21e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare dataset for plotting</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_109_data <span class="ot">&lt;-</span> glucose_fit_109_data <span class="sc">%&gt;%</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_109_orig))</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(glucose_fit_109_data, <span class="fu">aes</span>(<span class="at">x =</span> dec.time, <span class="at">y =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span>  <span class="co"># Original glucose values</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Cosinus fit</span></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Manual Cosinus-Fit for 109 with original data"</span>,</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"time (decimal hours)"</span>,</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Glucose (mg/dl)"</span>) <span class="sc">+</span></span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Fit for 112</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>cos_fit_112_orig <span class="ot">&lt;-</span> <span class="fu">nls</span>(</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">24</span> <span class="sc">*</span> dec.time <span class="sc">+</span> phi) <span class="sc">+</span> C,</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> glucose_fit_112_data,</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">phi =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">100</span>)  <span class="co"># start values</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ergebnis anzeigen</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_112_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)    
A    8.88320    0.11129   79.82   &lt;2e-16 ***
phi  1.01546    0.01247   81.45   &lt;2e-16 ***
C   98.38159    0.07850 1253.20   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.77 on 40345 degrees of freedom

Number of iterations to convergence: 5 
Achieved convergence tolerance: 7.447e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare dataset for plotting</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>glucose_fit_112_data <span class="ot">&lt;-</span> glucose_fit_112_data <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fitted =</span> <span class="fu">predict</span>(cos_fit_112_orig))</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(glucose_fit_112_data, <span class="fu">aes</span>(<span class="at">x =</span> dec.time, <span class="at">y =</span> <span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span>  <span class="co"># Original glucose values</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fitted), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Cosinus fit</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Manual Cosinus-Fit for 112 with original data"</span>,</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"time (decimal hours)"</span>,</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Glucose (mg/dl)"</span>) <span class="sc">+</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparison-of-outputs-of-the-different-fits" class="level3">
<h3 class="anchored" data-anchor-id="comparison-of-outputs-of-the-different-fits">Comparison of outputs of the different fits</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_102)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: Avg_Glucose ~ A * cos(2 * pi/24 * Hour_Rounded + phi) + C

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)    
A   -6.37619    0.30189  -21.12   &lt;2e-16 ***
phi -1.17838    0.04735  -24.89   &lt;2e-16 ***
C   99.79182    0.21347  467.47   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.479 on 45 degrees of freedom

Number of iterations to convergence: 8 
Achieved convergence tolerance: 7.629e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_102)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  99.7942         0.0503  99.6956  99.8928       0
rrr          -1.6710         0.0711  -1.8103  -1.5318       0
sss          -6.1713         0.0712  -6.3108  -6.0317       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  99.7942         0.0503  99.6956  99.8928       0
amp           6.3935         0.0712   6.2540   6.5330       0
acr           1.3064         0.0111   1.2846   1.3282       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_102_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)    
A    6.39349    0.07116   89.84   &lt;2e-16 ***
phi -4.44795    0.01112 -399.88   &lt;2e-16 ***
C   99.79418    0.05030 1983.89   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.98 on 77228 degrees of freedom

Number of iterations to convergence: 10 
Achieved convergence tolerance: 1.922e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_104)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: Avg_Glucose ~ A * cos(2 * pi/24 * Hour_Rounded + phi) + C

Parameters:
     Estimate Std. Error t value Pr(&gt;|t|)    
A     3.48348    0.34795   10.01 5.02e-13 ***
phi   1.41791    0.09989   14.20  &lt; 2e-16 ***
C   100.01349    0.24604  406.49  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.705 on 45 degrees of freedom

Number of iterations to convergence: 7 
Achieved convergence tolerance: 4.319e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_104)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept) 100.0121         0.0489  99.9163 100.1078       0
rrr           0.9574         0.0691   0.8220   1.0928       0
sss          -3.3675         0.0691  -3.5029  -3.2320       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept) 100.0121         0.0489  99.9163 100.1078       0
amp           3.5009         0.0691   3.3654   3.6364       0
acr          -1.2938         0.0197  -1.3325  -1.2551       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_104_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
     Estimate Std. Error t value Pr(&gt;|t|)    
A     3.50090    0.06912   50.65   &lt;2e-16 ***
phi   1.29380    0.01973   65.56   &lt;2e-16 ***
C   100.01206    0.04886 2046.78   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.79 on 91590 degrees of freedom

Number of iterations to convergence: 7 
Achieved convergence tolerance: 1.57e-09</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_107)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: Avg_Glucose ~ A * cos(2 * pi/24 * Hour_Rounded + phi) + C

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)    
A     6.1279     0.9707   6.313 1.07e-07 ***
phi   1.1679     0.1584   7.373 2.86e-09 ***
C    99.8717     0.6864 145.504  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.755 on 45 degrees of freedom

Number of iterations to convergence: 5 
Achieved convergence tolerance: 1.371e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_107)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  99.8672         0.0702  99.7297 100.0047       0
rrr           3.1165         0.0992   2.9221   3.3108       0
sss          -5.2599         0.0993  -5.4545  -5.0653       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  99.8672         0.0702  99.7297 100.0047       0
amp           6.1138         0.0993   5.9192   6.3085       0
acr          -1.0359         0.0162  -1.0677  -1.0041       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_107_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)    
A    6.11375    0.09932   61.56   &lt;2e-16 ***
phi  1.03591    0.01622   63.88   &lt;2e-16 ***
C   99.86721    0.07017 1423.26   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 16.62 on 56107 degrees of freedom

Number of iterations to convergence: 5 
Achieved convergence tolerance: 3.927e-06</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_108)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: Avg_Glucose ~ A * cos(2 * pi/24 * Hour_Rounded + phi) + C

Parameters:
     Estimate Std. Error t value Pr(&gt;|t|)    
A   -12.35366    0.72300  -17.09   &lt;2e-16 ***
phi   5.08807    0.05853   86.94   &lt;2e-16 ***
C   105.60168    0.51124  206.56   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.542 on 45 degrees of freedom

Number of iterations to convergence: 8 
Achieved convergence tolerance: 4.402e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_108)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept) 105.5868         0.1440 105.3046 105.8690       0
rrr          -2.9873         0.2036  -3.3864  -2.5881       0
sss         -12.0471         0.2036 -12.4461 -11.6481       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept) 105.5868         0.1440 105.3046 105.8690       0
amp          12.4119         0.2034  12.0133  12.8105       0
acr           1.3277         0.0164   1.2955   1.3599       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_108_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
     Estimate Std. Error t value Pr(&gt;|t|)    
A    12.41194    0.20337   61.03   &lt;2e-16 ***
phi  20.66341    0.01642 1258.09   &lt;2e-16 ***
C   105.58679    0.14398  733.36   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.79 on 12032 degrees of freedom

Number of iterations to convergence: 11 
Achieved convergence tolerance: 2.572e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_109)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: Avg_Glucose ~ A * cos(2 * pi/24 * Hour_Rounded + phi) + C

Parameters:
     Estimate Std. Error t value Pr(&gt;|t|)    
A     7.87606    0.40760   19.32   &lt;2e-16 ***
phi  76.95992    0.05175 1487.11   &lt;2e-16 ***
C   102.10521    0.28821  354.27   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.997 on 45 degrees of freedom

Number of iterations to convergence: 6 
Achieved convergence tolerance: 1.956e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_109)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept) 102.1091         0.0606 101.9904 102.2278       0
rrr           1.0739         0.0857   0.9060   1.2418       0
sss          -7.8340         0.0856  -8.0019  -7.6661       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept) 102.1091         0.0606 101.9904 102.2278       0
amp           7.9073         0.0856   7.7394   8.0751       0
acr          -1.4346         0.0108  -1.4558  -1.4133       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_109_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
     Estimate Std. Error t value Pr(&gt;|t|)    
A     7.90726    0.08563   92.35   &lt;2e-16 ***
phi   1.43456    0.01083  132.41   &lt;2e-16 ***
C   102.10915    0.06056 1686.00   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.87 on 45167 degrees of freedom

Number of iterations to convergence: 7 
Achieved convergence tolerance: 2.21e-09</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_112)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: Avg_Glucose ~ A * cos(2 * pi/24 * Hour_Rounded + phi) + C

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)    
A    8.82463    0.20097   43.91   &lt;2e-16 ***
phi  1.14426    0.02277   50.24   &lt;2e-16 ***
C   98.38137    0.14211  692.31   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9845 on 45 degrees of freedom

Number of iterations to convergence: 5 
Achieved convergence tolerance: 5.418e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glucose_fit_112)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw model coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  98.3816         0.0785  98.2277  98.5355       0
rrr           4.6835         0.1110   4.4660   4.9010       0
sss          -7.5482         0.1111  -7.7660  -7.3305       0

***********************

Transformed coefficients:
            estimate standard.error lower.CI upper.CI p.value
(Intercept)  98.3816         0.0785  98.2277  98.5355       0
amp           8.8832         0.1113   8.6651   9.1013       0
acr          -1.0155         0.0125  -1.0399  -0.9910       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cos_fit_112_orig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: `Glucose (mg/dl)` ~ A * cos(2 * pi/24 * dec.time + phi) + C

Parameters:
    Estimate Std. Error t value Pr(&gt;|t|)    
A    8.88320    0.11129   79.82   &lt;2e-16 ***
phi  1.01546    0.01247   81.45   &lt;2e-16 ***
C   98.38159    0.07850 1253.20   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.77 on 40345 degrees of freedom

Number of iterations to convergence: 5 
Achieved convergence tolerance: 7.447e-09</code></pre>
</div>
</div>
</section>
<section id="moving-window" class="level3">
<h3 class="anchored" data-anchor-id="moving-window">Moving window</h3>
<p><strong>Description:</strong> Cos for 102: Moving window for 102</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Storage for results</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>  moving_window_102 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Window_Start =</span> <span class="fu">as.POSIXct</span>(<span class="fu">character</span>()),</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Amp =</span> <span class="fu">numeric</span>(),</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Acrophase_Raw_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Time boundaries</span></span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>  start_time_mv_102 <span class="ot">&lt;-</span> <span class="fu">min</span>(glucose_fit_102_data<span class="sc">$</span>datetime)</span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>  end_time_mv_102 <span class="ot">&lt;-</span> <span class="fu">max</span>(glucose_fit_102_data<span class="sc">$</span>datetime)</span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Window setup</span></span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>  window_length <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">3</span>)</span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a>  step_size <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a>  current_start_102 <span class="ot">&lt;-</span> start_time_mv_102</span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (current_start_102 <span class="sc">+</span> window_length <span class="sc">&lt;=</span> end_time_mv_102) {</span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a>    current_end_102 <span class="ot">&lt;-</span> current_start_102 <span class="sc">+</span> window_length</span>
<span id="cb219-24"><a href="#cb219-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-25"><a href="#cb219-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter window</span></span>
<span id="cb219-26"><a href="#cb219-26" aria-hidden="true" tabindex="-1"></a>    window_data_102 <span class="ot">&lt;-</span> glucose_fit_102_data <span class="sc">%&gt;%</span></span>
<span id="cb219-27"><a href="#cb219-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(datetime <span class="sc">&gt;=</span> current_start_102 <span class="sc">&amp;</span> datetime <span class="sc">&lt;</span> current_end_102)</span>
<span id="cb219-28"><a href="#cb219-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-29"><a href="#cb219-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Skip small windows</span></span>
<span id="cb219-30"><a href="#cb219-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(window_data_102) <span class="sc">&lt;</span> <span class="dv">100</span>) {</span>
<span id="cb219-31"><a href="#cb219-31" aria-hidden="true" tabindex="-1"></a>      current_start_102 <span class="ot">&lt;-</span> current_start_102 <span class="sc">+</span> step_size</span>
<span id="cb219-32"><a href="#cb219-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb219-33"><a href="#cb219-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb219-34"><a href="#cb219-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-35"><a href="#cb219-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try fitting model</span></span>
<span id="cb219-36"><a href="#cb219-36" aria-hidden="true" tabindex="-1"></a>    fit_102 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb219-37"><a href="#cb219-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> window_data_102, <span class="at">period =</span> <span class="dv">24</span>)</span>
<span id="cb219-38"><a href="#cb219-38" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA</span>)</span>
<span id="cb219-39"><a href="#cb219-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-40"><a href="#cb219-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Proceed only if fit succeeded</span></span>
<span id="cb219-41"><a href="#cb219-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">inherits</span>(fit_102, <span class="st">"cosinor.lm"</span>)) {</span>
<span id="cb219-42"><a href="#cb219-42" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb219-43"><a href="#cb219-43" aria-hidden="true" tabindex="-1"></a>      coefs_102 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_102, <span class="at">transformed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb219-44"><a href="#cb219-44" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb219-45"><a href="#cb219-45" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Safe extraction</span></span>
<span id="cb219-46"><a href="#cb219-46" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.matrix</span>(coefs_102)) {</span>
<span id="cb219-47"><a href="#cb219-47" aria-hidden="true" tabindex="-1"></a>        amp_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"amp"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb219-48"><a href="#cb219-48" aria-hidden="true" tabindex="-1"></a>        acr_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"acr"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb219-49"><a href="#cb219-49" aria-hidden="true" tabindex="-1"></a>        intercept_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"(Intercept)"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb219-50"><a href="#cb219-50" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.vector</span>(coefs_102)) {</span>
<span id="cb219-51"><a href="#cb219-51" aria-hidden="true" tabindex="-1"></a>        amp_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"amp"</span>]</span>
<span id="cb219-52"><a href="#cb219-52" aria-hidden="true" tabindex="-1"></a>        acr_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"acr"</span>]</span>
<span id="cb219-53"><a href="#cb219-53" aria-hidden="true" tabindex="-1"></a>        intercept_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"(Intercept)"</span>]</span>
<span id="cb219-54"><a href="#cb219-54" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb219-55"><a href="#cb219-55" aria-hidden="true" tabindex="-1"></a>        current_start_102 <span class="ot">&lt;-</span> current_start_102 <span class="sc">+</span> step_size</span>
<span id="cb219-56"><a href="#cb219-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb219-57"><a href="#cb219-57" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb219-58"><a href="#cb219-58" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb219-59"><a href="#cb219-59" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb219-60"><a href="#cb219-60" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Raw acrophase in hours</span></span>
<span id="cb219-61"><a href="#cb219-61" aria-hidden="true" tabindex="-1"></a>    acrophase_raw_102 <span class="ot">&lt;-</span> (acr_102 <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb219-62"><a href="#cb219-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-63"><a href="#cb219-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate max time (adjusted by 12h if amplitude is negative)</span></span>
<span id="cb219-64"><a href="#cb219-64" aria-hidden="true" tabindex="-1"></a>    max_time_102 <span class="ot">&lt;-</span> ((acrophase_raw_102 <span class="sc">+</span> <span class="fu">ifelse</span>(amp_102 <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">0</span>)) <span class="sc">+</span> <span class="dv">24</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb219-65"><a href="#cb219-65" aria-hidden="true" tabindex="-1"></a>    min_time_102 <span class="ot">&lt;-</span> (max_time_102 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb219-66"><a href="#cb219-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-67"><a href="#cb219-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb219-68"><a href="#cb219-68" aria-hidden="true" tabindex="-1"></a>    moving_window_102 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(moving_window_102, <span class="fu">data.frame</span>(</span>
<span id="cb219-69"><a href="#cb219-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">Window_Start =</span> current_start_102,</span>
<span id="cb219-70"><a href="#cb219-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">Amp =</span> amp_102,</span>
<span id="cb219-71"><a href="#cb219-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">Acrophase_Raw_Hours =</span> (acrophase_raw_102 <span class="sc">+</span> <span class="dv">24</span>) <span class="sc">%%</span> <span class="dv">24</span>,</span>
<span id="cb219-72"><a href="#cb219-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">Max_Time_Hours =</span> max_time_102,</span>
<span id="cb219-73"><a href="#cb219-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">Min_Time_Hours =</span> min_time_102,</span>
<span id="cb219-74"><a href="#cb219-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">Intercept =</span> intercept_102</span>
<span id="cb219-75"><a href="#cb219-75" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb219-76"><a href="#cb219-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb219-77"><a href="#cb219-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb219-78"><a href="#cb219-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move to next window</span></span>
<span id="cb219-79"><a href="#cb219-79" aria-hidden="true" tabindex="-1"></a>  current_start_102 <span class="ot">&lt;-</span> current_start_102 <span class="sc">+</span> step_size</span>
<span id="cb219-80"><a href="#cb219-80" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description:</strong> Cos for 102: Plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moving_window_102, <span class="fu">aes</span>(<span class="at">x =</span> Window_Start)) <span class="sc">+</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>)) <span class="sc">+</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>)) <span class="sc">+</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>)) <span class="sc">+</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>)) <span class="sc">+</span></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Maximum"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Minimum"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">2</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Diurnal Pattern of Maximum and Minimum (Glucose Cosinor)"</span>,</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Window Start Time"</span>,</span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day (Hours)"</span>,</span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Point"</span></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 102: Define maxima and minima: Maxima &gt;12h, Minima &lt;12h + min. 400 datapoints are needed to calculate the cos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Empty dataframe to store results</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>moving_window_102 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Window_Start =</span> <span class="fu">as.POSIXct</span>(<span class="fu">character</span>()),</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amp =</span> <span class="fu">numeric</span>(),</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Acrophase_Raw_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define time boundaries</span></span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a>start_time_mv_102 <span class="ot">&lt;-</span> <span class="fu">min</span>(glucose_fit_102_data<span class="sc">$</span>datetime)</span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a>end_time_mv_102 <span class="ot">&lt;-</span> <span class="fu">max</span>(glucose_fit_102_data<span class="sc">$</span>datetime)</span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Window and step sizes</span></span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a>window_length <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">3</span>)</span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>step_size <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a>current_start_102 <span class="ot">&lt;-</span> start_time_mv_102</span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sliding window analysis</span></span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (current_start_102 <span class="sc">+</span> window_length <span class="sc">&lt;=</span> end_time_mv_102) {</span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a>  current_end_102 <span class="ot">&lt;-</span> current_start_102 <span class="sc">+</span> window_length</span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data within window</span></span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a>  window_data_102 <span class="ot">&lt;-</span> glucose_fit_102_data <span class="sc">%&gt;%</span></span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(datetime <span class="sc">&gt;=</span> current_start_102 <span class="sc">&amp;</span> datetime <span class="sc">&lt;</span> current_end_102)</span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Skip windows with too few data points</span></span>
<span id="cb221-31"><a href="#cb221-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(window_data_102) <span class="sc">&lt;</span> <span class="dv">400</span>) {</span>
<span id="cb221-32"><a href="#cb221-32" aria-hidden="true" tabindex="-1"></a>    current_start_102 <span class="ot">&lt;-</span> current_start_102 <span class="sc">+</span> step_size</span>
<span id="cb221-33"><a href="#cb221-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb221-34"><a href="#cb221-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb221-35"><a href="#cb221-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb221-36"><a href="#cb221-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit cosinor model</span></span>
<span id="cb221-37"><a href="#cb221-37" aria-hidden="true" tabindex="-1"></a>  fit_102 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb221-38"><a href="#cb221-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> window_data_102, <span class="at">period =</span> <span class="dv">24</span>)</span>
<span id="cb221-39"><a href="#cb221-39" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA</span>)</span>
<span id="cb221-40"><a href="#cb221-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb221-41"><a href="#cb221-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(fit_102, <span class="st">"cosinor.lm"</span>)) {</span>
<span id="cb221-42"><a href="#cb221-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-43"><a href="#cb221-43" aria-hidden="true" tabindex="-1"></a>    coefs_102 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_102, <span class="at">transformed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb221-44"><a href="#cb221-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-45"><a href="#cb221-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract coefficients</span></span>
<span id="cb221-46"><a href="#cb221-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.matrix</span>(coefs_102)) {</span>
<span id="cb221-47"><a href="#cb221-47" aria-hidden="true" tabindex="-1"></a>      amp_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"amp"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb221-48"><a href="#cb221-48" aria-hidden="true" tabindex="-1"></a>      acr_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"acr"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb221-49"><a href="#cb221-49" aria-hidden="true" tabindex="-1"></a>      intercept_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"(Intercept)"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb221-50"><a href="#cb221-50" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.vector</span>(coefs_102)) {</span>
<span id="cb221-51"><a href="#cb221-51" aria-hidden="true" tabindex="-1"></a>      amp_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"amp"</span>]</span>
<span id="cb221-52"><a href="#cb221-52" aria-hidden="true" tabindex="-1"></a>      acr_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"acr"</span>]</span>
<span id="cb221-53"><a href="#cb221-53" aria-hidden="true" tabindex="-1"></a>      intercept_102 <span class="ot">&lt;-</span> coefs_102[<span class="st">"(Intercept)"</span>]</span>
<span id="cb221-54"><a href="#cb221-54" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb221-55"><a href="#cb221-55" aria-hidden="true" tabindex="-1"></a>      current_start_102 <span class="ot">&lt;-</span> current_start_102 <span class="sc">+</span> step_size</span>
<span id="cb221-56"><a href="#cb221-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb221-57"><a href="#cb221-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb221-58"><a href="#cb221-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-59"><a href="#cb221-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Raw acrophase in hours</span></span>
<span id="cb221-60"><a href="#cb221-60" aria-hidden="true" tabindex="-1"></a>    acrophase_raw_102 <span class="ot">&lt;-</span> (acr_102 <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb221-61"><a href="#cb221-61" aria-hidden="true" tabindex="-1"></a>    acrophase_norm_102 <span class="ot">&lt;-</span> (acrophase_raw_102 <span class="sc">+</span> <span class="dv">24</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb221-62"><a href="#cb221-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-63"><a href="#cb221-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Max and min time depending on amplitude sign</span></span>
<span id="cb221-64"><a href="#cb221-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (amp_102 <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb221-65"><a href="#cb221-65" aria-hidden="true" tabindex="-1"></a>      max_time_102 <span class="ot">&lt;-</span> acrophase_norm_102</span>
<span id="cb221-66"><a href="#cb221-66" aria-hidden="true" tabindex="-1"></a>      min_time_102 <span class="ot">&lt;-</span> (acrophase_norm_102 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb221-67"><a href="#cb221-67" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb221-68"><a href="#cb221-68" aria-hidden="true" tabindex="-1"></a>      min_time_102 <span class="ot">&lt;-</span> acrophase_norm_102</span>
<span id="cb221-69"><a href="#cb221-69" aria-hidden="true" tabindex="-1"></a>      max_time_102 <span class="ot">&lt;-</span> (acrophase_norm_102 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb221-70"><a href="#cb221-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb221-71"><a href="#cb221-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-72"><a href="#cb221-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure max &gt; 12 and min &lt; 12 (if desired visual convention)</span></span>
<span id="cb221-73"><a href="#cb221-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (max_time_102 <span class="sc">&lt;</span> <span class="dv">12</span>) {</span>
<span id="cb221-74"><a href="#cb221-74" aria-hidden="true" tabindex="-1"></a>      temp_102 <span class="ot">&lt;-</span> max_time_102</span>
<span id="cb221-75"><a href="#cb221-75" aria-hidden="true" tabindex="-1"></a>      max_time_102 <span class="ot">&lt;-</span> min_time_102</span>
<span id="cb221-76"><a href="#cb221-76" aria-hidden="true" tabindex="-1"></a>      min_time_102 <span class="ot">&lt;-</span> temp_102</span>
<span id="cb221-77"><a href="#cb221-77" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb221-78"><a href="#cb221-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-79"><a href="#cb221-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb221-80"><a href="#cb221-80" aria-hidden="true" tabindex="-1"></a>    moving_window_102 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(moving_window_102, <span class="fu">data.frame</span>(</span>
<span id="cb221-81"><a href="#cb221-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">Window_Start =</span> current_start_102,</span>
<span id="cb221-82"><a href="#cb221-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">Amp =</span> amp_102,</span>
<span id="cb221-83"><a href="#cb221-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">Acrophase_Raw_Hours =</span> acrophase_norm_102,</span>
<span id="cb221-84"><a href="#cb221-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">Max_Time_Hours =</span> max_time_102,</span>
<span id="cb221-85"><a href="#cb221-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">Min_Time_Hours =</span> min_time_102,</span>
<span id="cb221-86"><a href="#cb221-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">Intercept =</span> intercept_102</span>
<span id="cb221-87"><a href="#cb221-87" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb221-88"><a href="#cb221-88" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb221-89"><a href="#cb221-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb221-90"><a href="#cb221-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move to next window</span></span>
<span id="cb221-91"><a href="#cb221-91" aria-hidden="true" tabindex="-1"></a>  current_start_102 <span class="ot">&lt;-</span> current_start_102 <span class="sc">+</span> step_size</span>
<span id="cb221-92"><a href="#cb221-92" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 102: Plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moving_window_102, <span class="fu">aes</span>(<span class="at">x =</span> Window_Start)) <span class="sc">+</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Time Point"</span>,</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Maximum"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Minimum"</span> <span class="ot">=</span> <span class="st">"blue"</span>)</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">2</span>),</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>),</span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Diurnal Timing of Maximum and Minimum (Glucose Cosinor)"</span>,</span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Window Start Time"</span>,</span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day (Hours)"</span></span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 104</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Empty dataframe to store results</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>moving_window_104 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Window_Start =</span> <span class="fu">as.POSIXct</span>(<span class="fu">character</span>()),</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amp =</span> <span class="fu">numeric</span>(),</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Acrophase_Raw_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define time boundaries</span></span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>start_time_mv_104 <span class="ot">&lt;-</span> <span class="fu">min</span>(glucose_fit_104_data<span class="sc">$</span>datetime)</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>end_time_mv_104 <span class="ot">&lt;-</span> <span class="fu">max</span>(glucose_fit_104_data<span class="sc">$</span>datetime)</span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Window and step sizes</span></span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>window_length <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">3</span>)</span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>step_size <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a>current_start_104 <span class="ot">&lt;-</span> start_time_mv_104</span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sliding window analysis</span></span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (current_start_104 <span class="sc">+</span> window_length <span class="sc">&lt;=</span> end_time_mv_104) {</span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a>  current_end_104 <span class="ot">&lt;-</span> current_start_104 <span class="sc">+</span> window_length</span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data within window</span></span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true" tabindex="-1"></a>  window_data_104 <span class="ot">&lt;-</span> glucose_fit_104_data <span class="sc">%&gt;%</span></span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(datetime <span class="sc">&gt;=</span> current_start_104 <span class="sc">&amp;</span> datetime <span class="sc">&lt;</span> current_end_104)</span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb223-30"><a href="#cb223-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Skip windows with too few data points</span></span>
<span id="cb223-31"><a href="#cb223-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(window_data_104) <span class="sc">&lt;</span> <span class="dv">400</span>) {</span>
<span id="cb223-32"><a href="#cb223-32" aria-hidden="true" tabindex="-1"></a>    current_start_104 <span class="ot">&lt;-</span> current_start_104 <span class="sc">+</span> step_size</span>
<span id="cb223-33"><a href="#cb223-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb223-34"><a href="#cb223-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb223-35"><a href="#cb223-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb223-36"><a href="#cb223-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit cosinor model</span></span>
<span id="cb223-37"><a href="#cb223-37" aria-hidden="true" tabindex="-1"></a>  fit_104 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb223-38"><a href="#cb223-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> window_data_104, <span class="at">period =</span> <span class="dv">24</span>)</span>
<span id="cb223-39"><a href="#cb223-39" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA</span>)</span>
<span id="cb223-40"><a href="#cb223-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb223-41"><a href="#cb223-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(fit_104, <span class="st">"cosinor.lm"</span>)) {</span>
<span id="cb223-42"><a href="#cb223-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb223-43"><a href="#cb223-43" aria-hidden="true" tabindex="-1"></a>    coefs_104 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_104, <span class="at">transformed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb223-44"><a href="#cb223-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb223-45"><a href="#cb223-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract coefficients</span></span>
<span id="cb223-46"><a href="#cb223-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.matrix</span>(coefs_104)) {</span>
<span id="cb223-47"><a href="#cb223-47" aria-hidden="true" tabindex="-1"></a>      amp_104 <span class="ot">&lt;-</span> coefs_104[<span class="st">"amp"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb223-48"><a href="#cb223-48" aria-hidden="true" tabindex="-1"></a>      acr_104 <span class="ot">&lt;-</span> coefs_104[<span class="st">"acr"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb223-49"><a href="#cb223-49" aria-hidden="true" tabindex="-1"></a>      intercept_104 <span class="ot">&lt;-</span> coefs_104[<span class="st">"(Intercept)"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb223-50"><a href="#cb223-50" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.vector</span>(coefs_104)) {</span>
<span id="cb223-51"><a href="#cb223-51" aria-hidden="true" tabindex="-1"></a>      amp_104 <span class="ot">&lt;-</span> coefs_104[<span class="st">"amp"</span>]</span>
<span id="cb223-52"><a href="#cb223-52" aria-hidden="true" tabindex="-1"></a>      acr_104 <span class="ot">&lt;-</span> coefs_104[<span class="st">"acr"</span>]</span>
<span id="cb223-53"><a href="#cb223-53" aria-hidden="true" tabindex="-1"></a>      intercept_104 <span class="ot">&lt;-</span> coefs_104[<span class="st">"(Intercept)"</span>]</span>
<span id="cb223-54"><a href="#cb223-54" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb223-55"><a href="#cb223-55" aria-hidden="true" tabindex="-1"></a>      current_start_104 <span class="ot">&lt;-</span> current_start_104 <span class="sc">+</span> step_size</span>
<span id="cb223-56"><a href="#cb223-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb223-57"><a href="#cb223-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb223-58"><a href="#cb223-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb223-59"><a href="#cb223-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Raw acrophase in hours</span></span>
<span id="cb223-60"><a href="#cb223-60" aria-hidden="true" tabindex="-1"></a>    acrophase_raw_104 <span class="ot">&lt;-</span> (acr_104 <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb223-61"><a href="#cb223-61" aria-hidden="true" tabindex="-1"></a>    acrophase_norm_104 <span class="ot">&lt;-</span> (acrophase_raw_104 <span class="sc">+</span> <span class="dv">24</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb223-62"><a href="#cb223-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb223-63"><a href="#cb223-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Max and min time depending on amplitude sign</span></span>
<span id="cb223-64"><a href="#cb223-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (amp_104 <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb223-65"><a href="#cb223-65" aria-hidden="true" tabindex="-1"></a>      max_time_104 <span class="ot">&lt;-</span> acrophase_norm_104</span>
<span id="cb223-66"><a href="#cb223-66" aria-hidden="true" tabindex="-1"></a>      min_time_104 <span class="ot">&lt;-</span> (acrophase_norm_104 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb223-67"><a href="#cb223-67" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb223-68"><a href="#cb223-68" aria-hidden="true" tabindex="-1"></a>      min_time_104 <span class="ot">&lt;-</span> acrophase_norm_104</span>
<span id="cb223-69"><a href="#cb223-69" aria-hidden="true" tabindex="-1"></a>      max_time_104 <span class="ot">&lt;-</span> (acrophase_norm_104 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb223-70"><a href="#cb223-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb223-71"><a href="#cb223-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb223-72"><a href="#cb223-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure max &gt; 12 and min &lt; 12 (if desired visual convention)</span></span>
<span id="cb223-73"><a href="#cb223-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (max_time_104 <span class="sc">&lt;</span> <span class="dv">12</span>) {</span>
<span id="cb223-74"><a href="#cb223-74" aria-hidden="true" tabindex="-1"></a>      temp_104 <span class="ot">&lt;-</span> max_time_104</span>
<span id="cb223-75"><a href="#cb223-75" aria-hidden="true" tabindex="-1"></a>      max_time_104 <span class="ot">&lt;-</span> min_time_104</span>
<span id="cb223-76"><a href="#cb223-76" aria-hidden="true" tabindex="-1"></a>      min_time_104 <span class="ot">&lt;-</span> temp_104</span>
<span id="cb223-77"><a href="#cb223-77" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb223-78"><a href="#cb223-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb223-79"><a href="#cb223-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb223-80"><a href="#cb223-80" aria-hidden="true" tabindex="-1"></a>    moving_window_104 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(moving_window_104, <span class="fu">data.frame</span>(</span>
<span id="cb223-81"><a href="#cb223-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">Window_Start =</span> current_start_104,</span>
<span id="cb223-82"><a href="#cb223-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">Amp =</span> amp_104,</span>
<span id="cb223-83"><a href="#cb223-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">Acrophase_Raw_Hours =</span> acrophase_norm_104,</span>
<span id="cb223-84"><a href="#cb223-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">Max_Time_Hours =</span> max_time_104,</span>
<span id="cb223-85"><a href="#cb223-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">Min_Time_Hours =</span> min_time_104,</span>
<span id="cb223-86"><a href="#cb223-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">Intercept =</span> intercept_104</span>
<span id="cb223-87"><a href="#cb223-87" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb223-88"><a href="#cb223-88" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb223-89"><a href="#cb223-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb223-90"><a href="#cb223-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move to next window</span></span>
<span id="cb223-91"><a href="#cb223-91" aria-hidden="true" tabindex="-1"></a>  current_start_104 <span class="ot">&lt;-</span> current_start_104 <span class="sc">+</span> step_size</span>
<span id="cb223-92"><a href="#cb223-92" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 104: Plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moving_window_104, <span class="fu">aes</span>(<span class="at">x =</span> Window_Start)) <span class="sc">+</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Time Point"</span>,</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Maximum"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Minimum"</span> <span class="ot">=</span> <span class="st">"blue"</span>)</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">2</span>),</span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>),</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Diurnal Timing of Maximum and Minimum (Glucose Cosinor)"</span>,</span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Window Start Time"</span>,</span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day (Hours)"</span></span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 107</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Empty dataframe to store results</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>moving_window_107 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Window_Start =</span> <span class="fu">as.POSIXct</span>(<span class="fu">character</span>()),</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amp =</span> <span class="fu">numeric</span>(),</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Acrophase_Raw_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define time boundaries</span></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>start_time_mv_107 <span class="ot">&lt;-</span> <span class="fu">min</span>(glucose_fit_107_data<span class="sc">$</span>datetime)</span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>end_time_mv_107 <span class="ot">&lt;-</span> <span class="fu">max</span>(glucose_fit_107_data<span class="sc">$</span>datetime)</span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Window and step sizes</span></span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>window_length <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">3</span>)</span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a>step_size <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>current_start_107 <span class="ot">&lt;-</span> start_time_mv_107</span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sliding window analysis</span></span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (current_start_107 <span class="sc">+</span> window_length <span class="sc">&lt;=</span> end_time_mv_107) {</span>
<span id="cb225-23"><a href="#cb225-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-24"><a href="#cb225-24" aria-hidden="true" tabindex="-1"></a>  current_end_107 <span class="ot">&lt;-</span> current_start_107 <span class="sc">+</span> window_length</span>
<span id="cb225-25"><a href="#cb225-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-26"><a href="#cb225-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data within window</span></span>
<span id="cb225-27"><a href="#cb225-27" aria-hidden="true" tabindex="-1"></a>  window_data_107 <span class="ot">&lt;-</span> glucose_fit_107_data <span class="sc">%&gt;%</span></span>
<span id="cb225-28"><a href="#cb225-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(datetime <span class="sc">&gt;=</span> current_start_107 <span class="sc">&amp;</span> datetime <span class="sc">&lt;</span> current_end_107)</span>
<span id="cb225-29"><a href="#cb225-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-30"><a href="#cb225-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Skip windows with too few data points</span></span>
<span id="cb225-31"><a href="#cb225-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(window_data_107) <span class="sc">&lt;</span> <span class="dv">400</span>) {</span>
<span id="cb225-32"><a href="#cb225-32" aria-hidden="true" tabindex="-1"></a>    current_start_107 <span class="ot">&lt;-</span> current_start_107 <span class="sc">+</span> step_size</span>
<span id="cb225-33"><a href="#cb225-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb225-34"><a href="#cb225-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb225-35"><a href="#cb225-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-36"><a href="#cb225-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit cosinor model</span></span>
<span id="cb225-37"><a href="#cb225-37" aria-hidden="true" tabindex="-1"></a>  fit_107 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb225-38"><a href="#cb225-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> window_data_107, <span class="at">period =</span> <span class="dv">24</span>)</span>
<span id="cb225-39"><a href="#cb225-39" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA</span>)</span>
<span id="cb225-40"><a href="#cb225-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-41"><a href="#cb225-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(fit_107, <span class="st">"cosinor.lm"</span>)) {</span>
<span id="cb225-42"><a href="#cb225-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb225-43"><a href="#cb225-43" aria-hidden="true" tabindex="-1"></a>    coefs_107 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_107, <span class="at">transformed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb225-44"><a href="#cb225-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb225-45"><a href="#cb225-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract coefficients</span></span>
<span id="cb225-46"><a href="#cb225-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.matrix</span>(coefs_107)) {</span>
<span id="cb225-47"><a href="#cb225-47" aria-hidden="true" tabindex="-1"></a>      amp_107 <span class="ot">&lt;-</span> coefs_107[<span class="st">"amp"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb225-48"><a href="#cb225-48" aria-hidden="true" tabindex="-1"></a>      acr_107 <span class="ot">&lt;-</span> coefs_107[<span class="st">"acr"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb225-49"><a href="#cb225-49" aria-hidden="true" tabindex="-1"></a>      intercept_107 <span class="ot">&lt;-</span> coefs_107[<span class="st">"(Intercept)"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb225-50"><a href="#cb225-50" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.vector</span>(coefs_107)) {</span>
<span id="cb225-51"><a href="#cb225-51" aria-hidden="true" tabindex="-1"></a>      amp_107 <span class="ot">&lt;-</span> coefs_107[<span class="st">"amp"</span>]</span>
<span id="cb225-52"><a href="#cb225-52" aria-hidden="true" tabindex="-1"></a>      acr_107 <span class="ot">&lt;-</span> coefs_107[<span class="st">"acr"</span>]</span>
<span id="cb225-53"><a href="#cb225-53" aria-hidden="true" tabindex="-1"></a>      intercept_107 <span class="ot">&lt;-</span> coefs_107[<span class="st">"(Intercept)"</span>]</span>
<span id="cb225-54"><a href="#cb225-54" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb225-55"><a href="#cb225-55" aria-hidden="true" tabindex="-1"></a>      current_start_107 <span class="ot">&lt;-</span> current_start_107 <span class="sc">+</span> step_size</span>
<span id="cb225-56"><a href="#cb225-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb225-57"><a href="#cb225-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb225-58"><a href="#cb225-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb225-59"><a href="#cb225-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Raw acrophase in hours</span></span>
<span id="cb225-60"><a href="#cb225-60" aria-hidden="true" tabindex="-1"></a>    acrophase_raw_107 <span class="ot">&lt;-</span> (acr_107 <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb225-61"><a href="#cb225-61" aria-hidden="true" tabindex="-1"></a>    acrophase_norm_107 <span class="ot">&lt;-</span> (acrophase_raw_107 <span class="sc">+</span> <span class="dv">24</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb225-62"><a href="#cb225-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb225-63"><a href="#cb225-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Max and min time depending on amplitude sign</span></span>
<span id="cb225-64"><a href="#cb225-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (amp_107 <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb225-65"><a href="#cb225-65" aria-hidden="true" tabindex="-1"></a>      max_time_107 <span class="ot">&lt;-</span> acrophase_norm_107</span>
<span id="cb225-66"><a href="#cb225-66" aria-hidden="true" tabindex="-1"></a>      min_time_107 <span class="ot">&lt;-</span> (acrophase_norm_107 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb225-67"><a href="#cb225-67" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb225-68"><a href="#cb225-68" aria-hidden="true" tabindex="-1"></a>      min_time_107 <span class="ot">&lt;-</span> acrophase_norm_107</span>
<span id="cb225-69"><a href="#cb225-69" aria-hidden="true" tabindex="-1"></a>      max_time_107 <span class="ot">&lt;-</span> (acrophase_norm_107 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb225-70"><a href="#cb225-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb225-71"><a href="#cb225-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb225-72"><a href="#cb225-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure max &gt; 12 and min &lt; 12 (if desired visual convention)</span></span>
<span id="cb225-73"><a href="#cb225-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (max_time_107 <span class="sc">&lt;</span> <span class="dv">12</span>) {</span>
<span id="cb225-74"><a href="#cb225-74" aria-hidden="true" tabindex="-1"></a>      temp_107 <span class="ot">&lt;-</span> max_time_107</span>
<span id="cb225-75"><a href="#cb225-75" aria-hidden="true" tabindex="-1"></a>      max_time_107 <span class="ot">&lt;-</span> min_time_107</span>
<span id="cb225-76"><a href="#cb225-76" aria-hidden="true" tabindex="-1"></a>      min_time_107 <span class="ot">&lt;-</span> temp_107</span>
<span id="cb225-77"><a href="#cb225-77" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb225-78"><a href="#cb225-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb225-79"><a href="#cb225-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb225-80"><a href="#cb225-80" aria-hidden="true" tabindex="-1"></a>    moving_window_107 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(moving_window_107, <span class="fu">data.frame</span>(</span>
<span id="cb225-81"><a href="#cb225-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">Window_Start =</span> current_start_107,</span>
<span id="cb225-82"><a href="#cb225-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">Amp =</span> amp_107,</span>
<span id="cb225-83"><a href="#cb225-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">Acrophase_Raw_Hours =</span> acrophase_norm_107,</span>
<span id="cb225-84"><a href="#cb225-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">Max_Time_Hours =</span> max_time_107,</span>
<span id="cb225-85"><a href="#cb225-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">Min_Time_Hours =</span> min_time_107,</span>
<span id="cb225-86"><a href="#cb225-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">Intercept =</span> intercept_107</span>
<span id="cb225-87"><a href="#cb225-87" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb225-88"><a href="#cb225-88" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb225-89"><a href="#cb225-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-90"><a href="#cb225-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move to next window</span></span>
<span id="cb225-91"><a href="#cb225-91" aria-hidden="true" tabindex="-1"></a>  current_start_107 <span class="ot">&lt;-</span> current_start_107 <span class="sc">+</span> step_size</span>
<span id="cb225-92"><a href="#cb225-92" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 107: Plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moving_window_107, <span class="fu">aes</span>(<span class="at">x =</span> Window_Start)) <span class="sc">+</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Time Point"</span>,</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Maximum"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Minimum"</span> <span class="ot">=</span> <span class="st">"blue"</span>)</span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">2</span>),</span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>),</span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Diurnal Timing of Maximum and Minimum (Glucose Cosinor)"</span>,</span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Window Start Time"</span>,</span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day (Hours)"</span></span>
<span id="cb226-19"><a href="#cb226-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb226-20"><a href="#cb226-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb226-21"><a href="#cb226-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 108</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Empty dataframe to store results</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>moving_window_108 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Window_Start =</span> <span class="fu">as.POSIXct</span>(<span class="fu">character</span>()),</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amp =</span> <span class="fu">numeric</span>(),</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Acrophase_Raw_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define time boundaries</span></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>start_time_mv_108 <span class="ot">&lt;-</span> <span class="fu">min</span>(glucose_fit_108_data<span class="sc">$</span>datetime)</span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>end_time_mv_108 <span class="ot">&lt;-</span> <span class="fu">max</span>(glucose_fit_108_data<span class="sc">$</span>datetime)</span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Window and step sizes</span></span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a>window_length <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">3</span>)</span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>step_size <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>current_start_108 <span class="ot">&lt;-</span> start_time_mv_108</span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sliding window analysis</span></span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (current_start_108 <span class="sc">+</span> window_length <span class="sc">&lt;=</span> end_time_mv_108) {</span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a>  current_end_108 <span class="ot">&lt;-</span> current_start_108 <span class="sc">+</span> window_length</span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-26"><a href="#cb227-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data within window</span></span>
<span id="cb227-27"><a href="#cb227-27" aria-hidden="true" tabindex="-1"></a>  window_data_108 <span class="ot">&lt;-</span> glucose_fit_108_data <span class="sc">%&gt;%</span></span>
<span id="cb227-28"><a href="#cb227-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(datetime <span class="sc">&gt;=</span> current_start_108 <span class="sc">&amp;</span> datetime <span class="sc">&lt;</span> current_end_108)</span>
<span id="cb227-29"><a href="#cb227-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-30"><a href="#cb227-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Skip windows with too few data points</span></span>
<span id="cb227-31"><a href="#cb227-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(window_data_108) <span class="sc">&lt;</span> <span class="dv">400</span>) {</span>
<span id="cb227-32"><a href="#cb227-32" aria-hidden="true" tabindex="-1"></a>    current_start_108 <span class="ot">&lt;-</span> current_start_108 <span class="sc">+</span> step_size</span>
<span id="cb227-33"><a href="#cb227-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb227-34"><a href="#cb227-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb227-35"><a href="#cb227-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-36"><a href="#cb227-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit cosinor model</span></span>
<span id="cb227-37"><a href="#cb227-37" aria-hidden="true" tabindex="-1"></a>  fit_108 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb227-38"><a href="#cb227-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> window_data_108, <span class="at">period =</span> <span class="dv">24</span>)</span>
<span id="cb227-39"><a href="#cb227-39" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA</span>)</span>
<span id="cb227-40"><a href="#cb227-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-41"><a href="#cb227-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(fit_108, <span class="st">"cosinor.lm"</span>)) {</span>
<span id="cb227-42"><a href="#cb227-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-43"><a href="#cb227-43" aria-hidden="true" tabindex="-1"></a>    coefs_108 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_108, <span class="at">transformed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb227-44"><a href="#cb227-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-45"><a href="#cb227-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract coefficients</span></span>
<span id="cb227-46"><a href="#cb227-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.matrix</span>(coefs_108)) {</span>
<span id="cb227-47"><a href="#cb227-47" aria-hidden="true" tabindex="-1"></a>      amp_108 <span class="ot">&lt;-</span> coefs_108[<span class="st">"amp"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb227-48"><a href="#cb227-48" aria-hidden="true" tabindex="-1"></a>      acr_108 <span class="ot">&lt;-</span> coefs_108[<span class="st">"acr"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb227-49"><a href="#cb227-49" aria-hidden="true" tabindex="-1"></a>      intercept_108 <span class="ot">&lt;-</span> coefs_108[<span class="st">"(Intercept)"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb227-50"><a href="#cb227-50" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.vector</span>(coefs_108)) {</span>
<span id="cb227-51"><a href="#cb227-51" aria-hidden="true" tabindex="-1"></a>      amp_108 <span class="ot">&lt;-</span> coefs_108[<span class="st">"amp"</span>]</span>
<span id="cb227-52"><a href="#cb227-52" aria-hidden="true" tabindex="-1"></a>      acr_108 <span class="ot">&lt;-</span> coefs_108[<span class="st">"acr"</span>]</span>
<span id="cb227-53"><a href="#cb227-53" aria-hidden="true" tabindex="-1"></a>      intercept_108 <span class="ot">&lt;-</span> coefs_108[<span class="st">"(Intercept)"</span>]</span>
<span id="cb227-54"><a href="#cb227-54" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb227-55"><a href="#cb227-55" aria-hidden="true" tabindex="-1"></a>      current_start_108 <span class="ot">&lt;-</span> current_start_108 <span class="sc">+</span> step_size</span>
<span id="cb227-56"><a href="#cb227-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb227-57"><a href="#cb227-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb227-58"><a href="#cb227-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-59"><a href="#cb227-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Raw acrophase in hours</span></span>
<span id="cb227-60"><a href="#cb227-60" aria-hidden="true" tabindex="-1"></a>    acrophase_raw_108 <span class="ot">&lt;-</span> (acr_108 <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb227-61"><a href="#cb227-61" aria-hidden="true" tabindex="-1"></a>    acrophase_norm_108 <span class="ot">&lt;-</span> (acrophase_raw_108 <span class="sc">+</span> <span class="dv">24</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb227-62"><a href="#cb227-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-63"><a href="#cb227-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Max and min time depending on amplitude sign</span></span>
<span id="cb227-64"><a href="#cb227-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (amp_108 <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb227-65"><a href="#cb227-65" aria-hidden="true" tabindex="-1"></a>      max_time_108 <span class="ot">&lt;-</span> acrophase_norm_108</span>
<span id="cb227-66"><a href="#cb227-66" aria-hidden="true" tabindex="-1"></a>      min_time_108 <span class="ot">&lt;-</span> (acrophase_norm_108 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb227-67"><a href="#cb227-67" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb227-68"><a href="#cb227-68" aria-hidden="true" tabindex="-1"></a>      min_time_108 <span class="ot">&lt;-</span> acrophase_norm_108</span>
<span id="cb227-69"><a href="#cb227-69" aria-hidden="true" tabindex="-1"></a>      max_time_108 <span class="ot">&lt;-</span> (acrophase_norm_108 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb227-70"><a href="#cb227-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb227-71"><a href="#cb227-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-72"><a href="#cb227-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure max &gt; 12 and min &lt; 12 (if desired visual convention)</span></span>
<span id="cb227-73"><a href="#cb227-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (max_time_108 <span class="sc">&lt;</span> <span class="dv">12</span>) {</span>
<span id="cb227-74"><a href="#cb227-74" aria-hidden="true" tabindex="-1"></a>      temp_108 <span class="ot">&lt;-</span> max_time_108</span>
<span id="cb227-75"><a href="#cb227-75" aria-hidden="true" tabindex="-1"></a>      max_time_108 <span class="ot">&lt;-</span> min_time_108</span>
<span id="cb227-76"><a href="#cb227-76" aria-hidden="true" tabindex="-1"></a>      min_time_108 <span class="ot">&lt;-</span> temp_108</span>
<span id="cb227-77"><a href="#cb227-77" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb227-78"><a href="#cb227-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-79"><a href="#cb227-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb227-80"><a href="#cb227-80" aria-hidden="true" tabindex="-1"></a>    moving_window_108 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(moving_window_108, <span class="fu">data.frame</span>(</span>
<span id="cb227-81"><a href="#cb227-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">Window_Start =</span> current_start_108,</span>
<span id="cb227-82"><a href="#cb227-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">Amp =</span> amp_108,</span>
<span id="cb227-83"><a href="#cb227-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">Acrophase_Raw_Hours =</span> acrophase_norm_108,</span>
<span id="cb227-84"><a href="#cb227-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">Max_Time_Hours =</span> max_time_108,</span>
<span id="cb227-85"><a href="#cb227-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">Min_Time_Hours =</span> min_time_108,</span>
<span id="cb227-86"><a href="#cb227-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">Intercept =</span> intercept_108</span>
<span id="cb227-87"><a href="#cb227-87" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb227-88"><a href="#cb227-88" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb227-89"><a href="#cb227-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-90"><a href="#cb227-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move to next window</span></span>
<span id="cb227-91"><a href="#cb227-91" aria-hidden="true" tabindex="-1"></a>  current_start_108 <span class="ot">&lt;-</span> current_start_108 <span class="sc">+</span> step_size</span>
<span id="cb227-92"><a href="#cb227-92" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 108: Plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moving_window_108, <span class="fu">aes</span>(<span class="at">x =</span> Window_Start)) <span class="sc">+</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Time Point"</span>,</span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Maximum"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Minimum"</span> <span class="ot">=</span> <span class="st">"blue"</span>)</span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">2</span>),</span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>),</span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Diurnal Timing of Maximum and Minimum (Glucose Cosinor)"</span>,</span>
<span id="cb228-17"><a href="#cb228-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Window Start Time"</span>,</span>
<span id="cb228-18"><a href="#cb228-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day (Hours)"</span></span>
<span id="cb228-19"><a href="#cb228-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb228-20"><a href="#cb228-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb228-21"><a href="#cb228-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 109</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Empty dataframe to store results</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>moving_window_109 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Window_Start =</span> <span class="fu">as.POSIXct</span>(<span class="fu">character</span>()),</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amp =</span> <span class="fu">numeric</span>(),</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Acrophase_Raw_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define time boundaries</span></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>start_time_mv_109 <span class="ot">&lt;-</span> <span class="fu">min</span>(glucose_fit_109_data<span class="sc">$</span>datetime)</span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>end_time_mv_109 <span class="ot">&lt;-</span> <span class="fu">max</span>(glucose_fit_109_data<span class="sc">$</span>datetime)</span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Window and step sizes</span></span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a>window_length <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">3</span>)</span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a>step_size <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a>current_start_109 <span class="ot">&lt;-</span> start_time_mv_109</span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sliding window analysis</span></span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (current_start_109 <span class="sc">+</span> window_length <span class="sc">&lt;=</span> end_time_mv_109) {</span>
<span id="cb229-23"><a href="#cb229-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-24"><a href="#cb229-24" aria-hidden="true" tabindex="-1"></a>  current_end_109 <span class="ot">&lt;-</span> current_start_109 <span class="sc">+</span> window_length</span>
<span id="cb229-25"><a href="#cb229-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-26"><a href="#cb229-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data within window</span></span>
<span id="cb229-27"><a href="#cb229-27" aria-hidden="true" tabindex="-1"></a>  window_data_109 <span class="ot">&lt;-</span> glucose_fit_109_data <span class="sc">%&gt;%</span></span>
<span id="cb229-28"><a href="#cb229-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(datetime <span class="sc">&gt;=</span> current_start_109 <span class="sc">&amp;</span> datetime <span class="sc">&lt;</span> current_end_109)</span>
<span id="cb229-29"><a href="#cb229-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-30"><a href="#cb229-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Skip windows with too few data points</span></span>
<span id="cb229-31"><a href="#cb229-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(window_data_109) <span class="sc">&lt;</span> <span class="dv">400</span>) {</span>
<span id="cb229-32"><a href="#cb229-32" aria-hidden="true" tabindex="-1"></a>    current_start_109 <span class="ot">&lt;-</span> current_start_109 <span class="sc">+</span> step_size</span>
<span id="cb229-33"><a href="#cb229-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb229-34"><a href="#cb229-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb229-35"><a href="#cb229-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-36"><a href="#cb229-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit cosinor model</span></span>
<span id="cb229-37"><a href="#cb229-37" aria-hidden="true" tabindex="-1"></a>  fit_109 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb229-38"><a href="#cb229-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> window_data_109, <span class="at">period =</span> <span class="dv">24</span>)</span>
<span id="cb229-39"><a href="#cb229-39" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA</span>)</span>
<span id="cb229-40"><a href="#cb229-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-41"><a href="#cb229-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(fit_109, <span class="st">"cosinor.lm"</span>)) {</span>
<span id="cb229-42"><a href="#cb229-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb229-43"><a href="#cb229-43" aria-hidden="true" tabindex="-1"></a>    coefs_109 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_109, <span class="at">transformed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb229-44"><a href="#cb229-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb229-45"><a href="#cb229-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract coefficients</span></span>
<span id="cb229-46"><a href="#cb229-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.matrix</span>(coefs_109)) {</span>
<span id="cb229-47"><a href="#cb229-47" aria-hidden="true" tabindex="-1"></a>      amp_109 <span class="ot">&lt;-</span> coefs_109[<span class="st">"amp"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb229-48"><a href="#cb229-48" aria-hidden="true" tabindex="-1"></a>      acr_109 <span class="ot">&lt;-</span> coefs_109[<span class="st">"acr"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb229-49"><a href="#cb229-49" aria-hidden="true" tabindex="-1"></a>      intercept_109 <span class="ot">&lt;-</span> coefs_109[<span class="st">"(Intercept)"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb229-50"><a href="#cb229-50" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.vector</span>(coefs_109)) {</span>
<span id="cb229-51"><a href="#cb229-51" aria-hidden="true" tabindex="-1"></a>      amp_109 <span class="ot">&lt;-</span> coefs_109[<span class="st">"amp"</span>]</span>
<span id="cb229-52"><a href="#cb229-52" aria-hidden="true" tabindex="-1"></a>      acr_109 <span class="ot">&lt;-</span> coefs_109[<span class="st">"acr"</span>]</span>
<span id="cb229-53"><a href="#cb229-53" aria-hidden="true" tabindex="-1"></a>      intercept_109 <span class="ot">&lt;-</span> coefs_109[<span class="st">"(Intercept)"</span>]</span>
<span id="cb229-54"><a href="#cb229-54" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb229-55"><a href="#cb229-55" aria-hidden="true" tabindex="-1"></a>      current_start_109 <span class="ot">&lt;-</span> current_start_109 <span class="sc">+</span> step_size</span>
<span id="cb229-56"><a href="#cb229-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb229-57"><a href="#cb229-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb229-58"><a href="#cb229-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb229-59"><a href="#cb229-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Raw acrophase in hours</span></span>
<span id="cb229-60"><a href="#cb229-60" aria-hidden="true" tabindex="-1"></a>    acrophase_raw_109 <span class="ot">&lt;-</span> (acr_109 <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb229-61"><a href="#cb229-61" aria-hidden="true" tabindex="-1"></a>    acrophase_norm_109 <span class="ot">&lt;-</span> (acrophase_raw_109 <span class="sc">+</span> <span class="dv">24</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb229-62"><a href="#cb229-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb229-63"><a href="#cb229-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Max and min time depending on amplitude sign</span></span>
<span id="cb229-64"><a href="#cb229-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (amp_109 <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb229-65"><a href="#cb229-65" aria-hidden="true" tabindex="-1"></a>      max_time_109 <span class="ot">&lt;-</span> acrophase_norm_109</span>
<span id="cb229-66"><a href="#cb229-66" aria-hidden="true" tabindex="-1"></a>      min_time_109 <span class="ot">&lt;-</span> (acrophase_norm_109 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb229-67"><a href="#cb229-67" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb229-68"><a href="#cb229-68" aria-hidden="true" tabindex="-1"></a>      min_time_109 <span class="ot">&lt;-</span> acrophase_norm_109</span>
<span id="cb229-69"><a href="#cb229-69" aria-hidden="true" tabindex="-1"></a>      max_time_109 <span class="ot">&lt;-</span> (acrophase_norm_109 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb229-70"><a href="#cb229-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb229-71"><a href="#cb229-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb229-72"><a href="#cb229-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure max &gt; 12 and min &lt; 12 (if desired visual convention)</span></span>
<span id="cb229-73"><a href="#cb229-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (max_time_109 <span class="sc">&lt;</span> <span class="dv">12</span>) {</span>
<span id="cb229-74"><a href="#cb229-74" aria-hidden="true" tabindex="-1"></a>      temp_109 <span class="ot">&lt;-</span> max_time_109</span>
<span id="cb229-75"><a href="#cb229-75" aria-hidden="true" tabindex="-1"></a>      max_time_109 <span class="ot">&lt;-</span> min_time_109</span>
<span id="cb229-76"><a href="#cb229-76" aria-hidden="true" tabindex="-1"></a>      min_time_109 <span class="ot">&lt;-</span> temp_109</span>
<span id="cb229-77"><a href="#cb229-77" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb229-78"><a href="#cb229-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb229-79"><a href="#cb229-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb229-80"><a href="#cb229-80" aria-hidden="true" tabindex="-1"></a>    moving_window_109 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(moving_window_109, <span class="fu">data.frame</span>(</span>
<span id="cb229-81"><a href="#cb229-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">Window_Start =</span> current_start_109,</span>
<span id="cb229-82"><a href="#cb229-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">Amp =</span> amp_109,</span>
<span id="cb229-83"><a href="#cb229-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">Acrophase_Raw_Hours =</span> acrophase_norm_109,</span>
<span id="cb229-84"><a href="#cb229-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">Max_Time_Hours =</span> max_time_109,</span>
<span id="cb229-85"><a href="#cb229-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">Min_Time_Hours =</span> min_time_109,</span>
<span id="cb229-86"><a href="#cb229-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">Intercept =</span> intercept_109</span>
<span id="cb229-87"><a href="#cb229-87" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb229-88"><a href="#cb229-88" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb229-89"><a href="#cb229-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-90"><a href="#cb229-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move to next window</span></span>
<span id="cb229-91"><a href="#cb229-91" aria-hidden="true" tabindex="-1"></a>  current_start_109 <span class="ot">&lt;-</span> current_start_109 <span class="sc">+</span> step_size</span>
<span id="cb229-92"><a href="#cb229-92" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 109: Plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moving_window_109, <span class="fu">aes</span>(<span class="at">x =</span> Window_Start)) <span class="sc">+</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Time Point"</span>,</span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Maximum"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Minimum"</span> <span class="ot">=</span> <span class="st">"blue"</span>)</span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">2</span>),</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>),</span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Diurnal Timing of Maximum and Minimum (Glucose Cosinor)"</span>,</span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Window Start Time"</span>,</span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day (Hours)"</span></span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb230-21"><a href="#cb230-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 112</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Empty dataframe to store results</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>moving_window_112 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Window_Start =</span> <span class="fu">as.POSIXct</span>(<span class="fu">character</span>()),</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amp =</span> <span class="fu">numeric</span>(),</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Acrophase_Raw_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min_Time_Hours =</span> <span class="fu">numeric</span>(),</span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define time boundaries</span></span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a>start_time_mv_112 <span class="ot">&lt;-</span> <span class="fu">min</span>(glucose_fit_112_data<span class="sc">$</span>datetime)</span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true" tabindex="-1"></a>end_time_mv_112 <span class="ot">&lt;-</span> <span class="fu">max</span>(glucose_fit_112_data<span class="sc">$</span>datetime)</span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-16"><a href="#cb231-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Window and step sizes</span></span>
<span id="cb231-17"><a href="#cb231-17" aria-hidden="true" tabindex="-1"></a>window_length <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">3</span>)</span>
<span id="cb231-18"><a href="#cb231-18" aria-hidden="true" tabindex="-1"></a>step_size <span class="ot">&lt;-</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb231-19"><a href="#cb231-19" aria-hidden="true" tabindex="-1"></a>current_start_112 <span class="ot">&lt;-</span> start_time_mv_112</span>
<span id="cb231-20"><a href="#cb231-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-21"><a href="#cb231-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sliding window analysis</span></span>
<span id="cb231-22"><a href="#cb231-22" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (current_start_112 <span class="sc">+</span> window_length <span class="sc">&lt;=</span> end_time_mv_112) {</span>
<span id="cb231-23"><a href="#cb231-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb231-24"><a href="#cb231-24" aria-hidden="true" tabindex="-1"></a>  current_end_112 <span class="ot">&lt;-</span> current_start_112 <span class="sc">+</span> window_length</span>
<span id="cb231-25"><a href="#cb231-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb231-26"><a href="#cb231-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data within window</span></span>
<span id="cb231-27"><a href="#cb231-27" aria-hidden="true" tabindex="-1"></a>  window_data_112 <span class="ot">&lt;-</span> glucose_fit_112_data <span class="sc">%&gt;%</span></span>
<span id="cb231-28"><a href="#cb231-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(datetime <span class="sc">&gt;=</span> current_start_112 <span class="sc">&amp;</span> datetime <span class="sc">&lt;</span> current_end_112)</span>
<span id="cb231-29"><a href="#cb231-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb231-30"><a href="#cb231-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Skip windows with too few data points</span></span>
<span id="cb231-31"><a href="#cb231-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(window_data_112) <span class="sc">&lt;</span> <span class="dv">400</span>) {</span>
<span id="cb231-32"><a href="#cb231-32" aria-hidden="true" tabindex="-1"></a>    current_start_112 <span class="ot">&lt;-</span> current_start_112 <span class="sc">+</span> step_size</span>
<span id="cb231-33"><a href="#cb231-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb231-34"><a href="#cb231-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb231-35"><a href="#cb231-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb231-36"><a href="#cb231-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit cosinor model</span></span>
<span id="cb231-37"><a href="#cb231-37" aria-hidden="true" tabindex="-1"></a>  fit_112 <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb231-38"><a href="#cb231-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cosinor.lm</span>(<span class="st">`</span><span class="at">Glucose (mg/dl)</span><span class="st">`</span> <span class="sc">~</span> <span class="fu">time</span>(dec.time), <span class="at">data =</span> window_data_112, <span class="at">period =</span> <span class="dv">24</span>)</span>
<span id="cb231-39"><a href="#cb231-39" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA</span>)</span>
<span id="cb231-40"><a href="#cb231-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb231-41"><a href="#cb231-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(fit_112, <span class="st">"cosinor.lm"</span>)) {</span>
<span id="cb231-42"><a href="#cb231-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-43"><a href="#cb231-43" aria-hidden="true" tabindex="-1"></a>    coefs_112 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit_112, <span class="at">transformed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb231-44"><a href="#cb231-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-45"><a href="#cb231-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract coefficients</span></span>
<span id="cb231-46"><a href="#cb231-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.matrix</span>(coefs_112)) {</span>
<span id="cb231-47"><a href="#cb231-47" aria-hidden="true" tabindex="-1"></a>      amp_112 <span class="ot">&lt;-</span> coefs_112[<span class="st">"amp"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb231-48"><a href="#cb231-48" aria-hidden="true" tabindex="-1"></a>      acr_112 <span class="ot">&lt;-</span> coefs_112[<span class="st">"acr"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb231-49"><a href="#cb231-49" aria-hidden="true" tabindex="-1"></a>      intercept_112 <span class="ot">&lt;-</span> coefs_112[<span class="st">"(Intercept)"</span>, <span class="st">"estimate"</span>]</span>
<span id="cb231-50"><a href="#cb231-50" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.vector</span>(coefs_112)) {</span>
<span id="cb231-51"><a href="#cb231-51" aria-hidden="true" tabindex="-1"></a>      amp_112 <span class="ot">&lt;-</span> coefs_112[<span class="st">"amp"</span>]</span>
<span id="cb231-52"><a href="#cb231-52" aria-hidden="true" tabindex="-1"></a>      acr_112 <span class="ot">&lt;-</span> coefs_112[<span class="st">"acr"</span>]</span>
<span id="cb231-53"><a href="#cb231-53" aria-hidden="true" tabindex="-1"></a>      intercept_112 <span class="ot">&lt;-</span> coefs_112[<span class="st">"(Intercept)"</span>]</span>
<span id="cb231-54"><a href="#cb231-54" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb231-55"><a href="#cb231-55" aria-hidden="true" tabindex="-1"></a>      current_start_112 <span class="ot">&lt;-</span> current_start_112 <span class="sc">+</span> step_size</span>
<span id="cb231-56"><a href="#cb231-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb231-57"><a href="#cb231-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb231-58"><a href="#cb231-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-59"><a href="#cb231-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Raw acrophase in hours</span></span>
<span id="cb231-60"><a href="#cb231-60" aria-hidden="true" tabindex="-1"></a>    acrophase_raw_112 <span class="ot">&lt;-</span> (acr_112 <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb231-61"><a href="#cb231-61" aria-hidden="true" tabindex="-1"></a>    acrophase_norm_112 <span class="ot">&lt;-</span> (acrophase_raw_112 <span class="sc">+</span> <span class="dv">24</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb231-62"><a href="#cb231-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-63"><a href="#cb231-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Max and min time depending on amplitude sign</span></span>
<span id="cb231-64"><a href="#cb231-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (amp_112 <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb231-65"><a href="#cb231-65" aria-hidden="true" tabindex="-1"></a>      max_time_112 <span class="ot">&lt;-</span> acrophase_norm_112</span>
<span id="cb231-66"><a href="#cb231-66" aria-hidden="true" tabindex="-1"></a>      min_time_112 <span class="ot">&lt;-</span> (acrophase_norm_112 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb231-67"><a href="#cb231-67" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb231-68"><a href="#cb231-68" aria-hidden="true" tabindex="-1"></a>      min_time_112 <span class="ot">&lt;-</span> acrophase_norm_112</span>
<span id="cb231-69"><a href="#cb231-69" aria-hidden="true" tabindex="-1"></a>      max_time_112 <span class="ot">&lt;-</span> (acrophase_norm_112 <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%%</span> <span class="dv">24</span></span>
<span id="cb231-70"><a href="#cb231-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb231-71"><a href="#cb231-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-72"><a href="#cb231-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure max &gt; 12 and min &lt; 12 (if desired visual convention)</span></span>
<span id="cb231-73"><a href="#cb231-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (max_time_112 <span class="sc">&lt;</span> <span class="dv">12</span>) {</span>
<span id="cb231-74"><a href="#cb231-74" aria-hidden="true" tabindex="-1"></a>      temp_112 <span class="ot">&lt;-</span> max_time_112</span>
<span id="cb231-75"><a href="#cb231-75" aria-hidden="true" tabindex="-1"></a>      max_time_112 <span class="ot">&lt;-</span> min_time_112</span>
<span id="cb231-76"><a href="#cb231-76" aria-hidden="true" tabindex="-1"></a>      min_time_112 <span class="ot">&lt;-</span> temp_112</span>
<span id="cb231-77"><a href="#cb231-77" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb231-78"><a href="#cb231-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-79"><a href="#cb231-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb231-80"><a href="#cb231-80" aria-hidden="true" tabindex="-1"></a>    moving_window_112 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(moving_window_112, <span class="fu">data.frame</span>(</span>
<span id="cb231-81"><a href="#cb231-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">Window_Start =</span> current_start_112,</span>
<span id="cb231-82"><a href="#cb231-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">Amp =</span> amp_112,</span>
<span id="cb231-83"><a href="#cb231-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">Acrophase_Raw_Hours =</span> acrophase_norm_112,</span>
<span id="cb231-84"><a href="#cb231-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">Max_Time_Hours =</span> max_time_112,</span>
<span id="cb231-85"><a href="#cb231-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">Min_Time_Hours =</span> min_time_112,</span>
<span id="cb231-86"><a href="#cb231-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">Intercept =</span> intercept_112</span>
<span id="cb231-87"><a href="#cb231-87" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb231-88"><a href="#cb231-88" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb231-89"><a href="#cb231-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb231-90"><a href="#cb231-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move to next window</span></span>
<span id="cb231-91"><a href="#cb231-91" aria-hidden="true" tabindex="-1"></a>  current_start_112 <span class="ot">&lt;-</span> current_start_112 <span class="sc">+</span> step_size</span>
<span id="cb231-92"><a href="#cb231-92" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Description:</strong> Moving Window Cos for 112: Plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moving_window_112, <span class="fu">aes</span>(<span class="at">x =</span> Window_Start)) <span class="sc">+</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Max_Time_Hours, <span class="at">color =</span> <span class="st">"Maximum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Min_Time_Hours, <span class="at">color =</span> <span class="st">"Minimum"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Time Point"</span>,</span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Maximum"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Minimum"</span> <span class="ot">=</span> <span class="st">"blue"</span>)</span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">2</span>),</span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>),</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Diurnal Timing of Maximum and Minimum (Glucose Cosinor)"</span>,</span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Window Start Time"</span>,</span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Time of Day (Hours)"</span></span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-20"><a href="#cb232-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb232-21"><a href="#cb232-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Masterarbeit_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="polar-plots-for-max-and-min" class="level3">
<h3 class="anchored" data-anchor-id="polar-plots-for-max-and-min">Polar Plots for Max and Min</h3>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>